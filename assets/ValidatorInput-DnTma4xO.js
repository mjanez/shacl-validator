const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-ADvRmTNE.js","assets/vendor-BQdnNnse.js","assets/charts-DG9K48Xb.js"])))=>i.map(i=>d[i]);
import{r as e,j as s,i as a,W as r,w as t,x as l}from"./vendor-BQdnNnse.js";import{c as i,a as n,T as o,b as d,d as c,B as u,e as m,D as x,f as p,g as h,h as f,u as v,_ as j,R as g}from"./index-cSWHyr3r.js";import{C as b,a as y,b as N,c as w,d as k,e as S}from"./card-D9fYY6CR.js";import{B as T}from"./badge-CZJJeZKD.js";import{I as C,d as z,T as D,e as P,f as E,g as L,h as U,i as R,X as B}from"./icons-DAOsTn3U.js";import{T as M,a as V,b as F,c as $}from"./tabs-DzknYpHZ.js";import"./charts-DG9K48Xb.js";import"./shacl-__0s_w47.js";import"./rdf-D0oavnFg.js";import"./ui-BQ6pezI-.js";const A=e.forwardRef(({className:e,...a},r)=>s.jsx("label",{ref:r,className:i("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));A.displayName="Label";const I=({selectedProfile:e,onProfileChange:r,disabled:t=!1})=>{const{t:l}=a(),i=n.profiles,v=(e,s)=>{const a=i[e],r=a?.versions?.[s];return r?l(`profiles.names.${e}.${s}`,{defaultValue:r.name}):e},j=(e,s)=>l(`profiles.branches.${e}`,{defaultValue:s||e}),g=i[e.profile],D=g.versions[e.version],P=Object.keys(g.versions).sort().reverse(),E=g.branches||{},L=Object.keys(E).length>0,U=e.branch||g.defaultBranch||"main",R=(e,a)=>s.jsxs(u,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:t||a,children:[s.jsx("span",{className:"text-sm font-medium",children:e}),s.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:s.jsx("path",{d:"M6 8l4 4 4-4"})})]});return s.jsxs(b,{className:"border border-border/70 bg-card",children:[s.jsxs(y,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx(N,{className:"text-base",children:l("validator.selectProfile")}),s.jsx(w,{children:l("validator.workspaceSubtitle")})]}),s.jsx(o,{children:s.jsxs(d,{children:[s.jsx(c,{asChild:!0,children:s.jsx(u,{variant:"ghost",size:"icon",asChild:!0,"aria-label":l("validator.profileInfo")??"Profile documentation",children:s.jsx("a",{href:D.url,target:"_blank",rel:"noreferrer",className:"text-muted-foreground",children:s.jsx(C,{className:"h-5 w-5"})})})}),s.jsx(m,{children:l("validator.profileInfo")})]})})]}),s.jsxs(k,{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(A,{children:l("validator.selectProfile")}),s.jsxs(x,{modal:!1,children:[s.jsx(p,{asChild:!0,children:(B=v(e.profile,e.version),s.jsxs(u,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:t,children:[s.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[D.icon&&s.jsx("img",{src:D.icon,alt:"",className:"h-6 w-6"}),B]}),s.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:s.jsx("path",{d:"M6 8l4 4 4-4"})})]}))}),s.jsx(h,{className:"min-w-[260px]",children:Object.keys(i).map(e=>{const a=i[e],t=a.versions[a.defaultVersion];return s.jsxs(f,{onSelect:s=>{s.preventDefault(),(e=>{const s=i[e].defaultVersion,a=i[e].defaultBranch||"main";r({profile:e,version:s,branch:a})})(e)},className:"flex items-center gap-3",children:[t.icon&&s.jsx("img",{src:t.icon,alt:"",className:"h-5 w-5"}),s.jsx("span",{children:v(e,a.defaultVersion)})]},e)})})]})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(A,{children:l("validator.version")}),s.jsxs(x,{modal:!1,children:[s.jsx(p,{asChild:!0,children:R(e.version,P.length<=1)}),s.jsx(h,{children:P.map(a=>s.jsxs(f,{onSelect:s=>{var t;s.preventDefault(),t=a,r({...e,version:t})},className:"flex items-center justify-between",children:[s.jsx("span",{children:a}),e.version===a&&s.jsx(z,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},a))})]})]}),L&&s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(A,{children:l("validator.branch")}),s.jsxs(x,{modal:!1,children:[s.jsx(p,{asChild:!0,children:R(j(U,E[U]),!1)}),s.jsx(h,{children:Object.entries(E).map(([a,t])=>s.jsxs(f,{onSelect:s=>{var t;s.preventDefault(),t=a,r({...e,branch:t})},className:"flex items-center justify-between",children:[s.jsx("span",{children:j(a,t)}),U===a&&s.jsx(z,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},a))})]})]})]}),s.jsxs(S,{className:"flex flex-wrap items-center justify-between gap-4 border-t border-border/60 bg-muted/30 px-6 py-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(T,{variant:"success",className:"uppercase tracking-tight",children:l("validator.currentProfile")}),s.jsx("span",{className:"text-xs text-muted-foreground/80",children:l("validator.profileReadyHint")})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-muted-foreground",children:[s.jsx(z,{className:"h-4 w-4 text-emerald-500","aria-hidden":"true"}),s.jsxs("span",{className:"font-medium text-foreground",children:[l("validator.validatingAgainst"),": ",s.jsx("span",{className:"text-muted-foreground",children:v(e.profile,e.version)})]})]})]})]});var B},_=e.forwardRef(({className:e,type:a="text",...r},t)=>s.jsx("input",{type:a,className:i("flex h-11 w-full rounded-md border border-input bg-background px-4 py-2 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...r}));_.displayName="Input";const O=e.forwardRef(({className:e,value:a=0,...r},t)=>s.jsx("div",{ref:t,className:i("relative h-2 w-full overflow-hidden rounded-full bg-muted",e),...r,children:s.jsx("div",{className:"h-full w-full flex-1 rounded-full bg-gradient-to-r from-primary to-accent transition-all",style:{transform:`translateX(-${100-Math.min(100,Math.max(0,a))}%)`}})}));function W({className:e,...a}){return s.jsx("div",{className:i("animate-pulse rounded-md bg-muted/60",e),...a})}O.displayName="Progress";const H=r.lazy(()=>j(()=>import("./monaco-ADvRmTNE.js"),__vite__mapDeps([0,1,2]))),J=({value:r,onChange:t,normalizedContent:l,jsonPreview:i})=>{const[n,o]=e.useState("json"),{t:d}=a(),{theme:c}=v(),u="dark"===c?"vs-dark":"vs-light",m="flex min-h-[57px] items-center justify-between border-b border-border px-4 py-2";return s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[s.jsx("div",{className:`${m} text-xs uppercase tracking-wide text-muted-foreground`,children:d("validator.pasteText")}),s.jsx("div",{className:"h-[420px]",children:s.jsx(e.Suspense,{fallback:s.jsx(W,{className:"h-full w-full rounded-none"}),children:s.jsx(H,{height:"100%",defaultLanguage:"turtle",theme:u,value:r,onChange:e=>t(e||""),options:{minimap:{enabled:!1},wordWrap:"on",fontSize:14,fontFamily:"JetBrains Mono",scrollBeyondLastLine:!1,automaticLayout:!0,renderLineHighlight:"none"}})})})]}),s.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[s.jsxs("div",{className:m,children:[s.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:d("validator.previewLabel")}),s.jsx(M,{value:n,onValueChange:e=>o(e),children:s.jsxs(V,{className:"bg-transparent p-0",children:[s.jsx(F,{value:"json",className:"rounded-full px-3 py-1 text-xs",children:d("validator.jsonPreview")}),s.jsx(F,{value:"turtle",className:"rounded-full px-3 py-1 text-xs",children:d("validator.normalizedPreview")})]})})]}),s.jsx("div",{className:"h-[420px]",children:s.jsx(e.Suspense,{fallback:s.jsx(W,{className:"h-full w-full rounded-none"}),children:s.jsx(H,{height:"100%",defaultLanguage:"json"===n?"json":"turtle",theme:u,value:"json"===n?i:l,options:{readOnly:!0,minimap:{enabled:!1},wordWrap:"on",fontSize:13,fontFamily:"JetBrains Mono",automaticLayout:!0,renderLineHighlight:"none"}})})})]})]})},Q=262144,q={datasets:0,dataServices:0,distributions:0,hasData:!1},G=({onValidate:r,isLoading:o})=>{const{t:d}=a(),{setRdfStats:c}=v(),[m]=t(),[x,p]=e.useState("paste"),[h,f]=e.useState(""),[j,S]=e.useState(""),[T,C]=e.useState(""),[z,A]=e.useState(""),[W,H]=e.useState(null),[G,K]=e.useState(null),[X,Y]=e.useState({progress:0,isUploading:!1,error:null}),[Z,ee]=e.useState(null),[se,ae]=e.useState({profile:"dcat_ap_es",version:"1.0.0",branch:"main"}),re=e.useRef(!1),[te,le]=e.useState(q);e.useEffect(()=>{const e=m.get("sample");if(e){const s=n.profiles[se.profile],a=s?.versions[se.version],r=a?.samples?.[e];r&&(A(r),p("url"))}},[m,se]),e.useEffect(()=>{if(!h.trim())return S(""),C(""),void le({...q});let e=!1;return(async()=>{try{const s=g.detectFormat(h),a=await g.parseRDF(h,s);if(e)return;const r=await g.normalizeToTurtle(h,{format:s});if(e)return;S(r),C(JSON.stringify(ie(a),null,2));const t=ne(a);le({...t,hasData:!0})}catch(s){le({...q})}})(),()=>{e=!0}},[h]);const ie=e=>{const s={},a=e.getQuads(null,null,null,null);for(const r of a){const e=r.subject.value;s[e]||(s[e]={"@id":e});const a=r.predicate.value,t="Literal"===r.object.termType?{"@value":r.object.value,"@type":r.object.datatype?.value,"@language":r.object.language||void 0}:{"@id":r.object.value};s[e][a]?s[e][a]=Array.isArray(s[e][a])?[...s[e][a],t]:[s[e][a],t]:s[e][a]=t}return Object.values(s)},ne=e=>{const s={datasets:new Set,dataServices:new Set,distributions:new Set},a=e.getQuads(null,null,null,null);for(const r of a){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!==r.predicate.value)continue;const e=r.subject.value;switch(r.object.value){case"http://www.w3.org/ns/dcat#Dataset":s.datasets.add(e);break;case"http://www.w3.org/ns/dcat#DataService":s.dataServices.add(e);break;case"http://www.w3.org/ns/dcat#Distribution":s.distributions.add(e)}}return{datasets:s.datasets.size,dataServices:s.dataServices.size,distributions:s.distributions.size}},oe=e.useCallback(async()=>{if(z.trim()){K(null);try{const e=await fetch(z,{method:"HEAD"});if(e.ok)return void H({size:e.headers.get("content-length")||void 0,contentType:e.headers.get("content-type")||void 0})}catch(e){}try{const e=await fetch(z,{method:"GET"});if(!e.ok)throw new Error("Failed metadata fetch");H({size:e.headers.get("content-length")||void 0,contentType:e.headers.get("content-type")||void 0})}catch(e){K(d("validator.urlError"))}}},[z,d]),de=e.useCallback(e=>new Promise((s,a)=>{const r=new FileReader;let t=0,l="";re.current=!1,Y({progress:0,isUploading:!0,error:null});const i=()=>{if(re.current)return Y({progress:0,isUploading:!1,error:d("validator.uploadCancelled")}),void a(new Error("Upload cancelled"));const s=e.slice(t,t+Q);r.readAsText(s)};r.onload=a=>{l+=a.target?.result,t+=Q;const r=Math.min(100,Math.round(t/e.size*100));Y(e=>({...e,progress:r})),t<e.size?i():(Y({progress:100,isUploading:!1,error:null}),s(l))},r.onerror=()=>{const e=r.error?.message||"Upload error";Y({progress:0,isUploading:!1,error:e}),ee(null),a(r.error||new Error(e))},i()}),[d]),ce=e.useCallback(async e=>{if(!e.length)return;const s=e[0];try{const e=await de(s);f(e),p("upload"),ee(s.name)}catch(a){ee(null)}},[de]),ue=e.useCallback(()=>{f(""),ee(null),Y({progress:0,isUploading:!1,error:null})},[]),{getRootProps:me,getInputProps:xe,isDragActive:pe}=l({accept:{"text/*":[".ttl",".rdf",".nt",".nq"],"application/ld+json":[".jsonld",".json"]},multiple:!1,onDropAccepted:ce}),he=()=>{const e=n.profiles[se.profile];let s=e?.versions[se.version]?.sampleUrl;s&&se.branch&&(s=s.replace("{branch}",se.branch)),s&&(A(s),p("url"))};e.useEffect(()=>{const e=n.profiles;if(!te.hasData)return void c(null);const s=e[se.profile]?.versions?.[se.version]?.icon;c({datasets:te.datasets,dataServices:te.dataServices,distributions:te.distributions,profileId:se.profile,profileVersion:se.version,profileBranch:se.branch,profileIcon:s})},[te,se,c]),e.useEffect(()=>()=>c(null),[c]);const fe=e.useMemo(()=>{const e="bg-emerald-500/15 text-emerald-600 dark:text-emerald-300",s="bg-sky-500/15 text-sky-700 dark:text-sky-200",a="bg-primary/15 text-primary";return[{key:"paste",title:d("validator.actions.pasteTitle"),description:d("validator.actions.pasteDescription"),icon:D,active:"paste"===x,status:h?{label:d("validator.actions.ready"),style:e}:void 0},{key:"url",title:d("validator.actions.urlTitle"),description:d("validator.actions.urlDescription"),icon:P,active:"url"===x,status:W?.contentType?{label:W.contentType.split(";")[0],style:s}:void 0},{key:"upload",title:d("validator.actions.uploadTitle"),description:d("validator.actions.uploadDescription"),icon:E,active:"upload"===x,status:X.isUploading?{label:`${X.progress}%`,style:a}:Z?{label:Z,style:s}:void 0}]},[x,h,W,X,Z,d]),ve=e.useMemo(()=>!!o||("paste"===x?!h.trim():"url"===x?!z.trim():"upload"!==x||!h.trim()),[x,h,z,o]);return s.jsxs("div",{className:"space-y-6",children:[s.jsx(I,{selectedProfile:se,onProfileChange:ae,disabled:o}),s.jsxs(b,{children:[s.jsxs(y,{children:[s.jsx(N,{children:d("validator.workspaceTitle")}),s.jsx(w,{children:d("validator.workspaceSubtitle")})]}),s.jsxs(k,{className:"space-y-6",children:[s.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:fe.map(e=>s.jsxs("button",{onClick:()=>p(e.key),className:i("rounded-2xl border p-4 text-left transition-all hover:border-primary hover:shadow-md",e.active?"border-primary/50 bg-primary/5":"border-border"),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(e.icon,{className:"h-5 w-5 text-primary","aria-hidden":"true"}),e.status&&s.jsx("span",{className:i("rounded-full px-2 py-0.5 text-xs font-semibold",e.status.style),children:e.status.label})]}),s.jsx("p",{className:"mt-3 font-semibold text-sm",children:e.title}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]},e.key))}),s.jsxs(M,{value:x,onValueChange:e=>p(e),children:[s.jsxs(V,{className:"w-full gap-2",children:[s.jsx(F,{value:"paste",children:d("validator.pasteText")}),s.jsx(F,{value:"url",children:d("validator.url")}),s.jsx(F,{value:"upload",children:d("validator.uploadTab")})]}),s.jsx($,{value:"paste",className:"border-0 p-0",children:s.jsx(e.Suspense,{fallback:s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(L,{className:"h-4 w-4 animate-spin"})," ",d("validator.loadingEditor")]}),children:s.jsx(J,{value:h,onChange:f,normalizedContent:j,jsonPreview:T})})}),s.jsx($,{value:"url",className:"border-0 p-0",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(_,{type:"url",placeholder:d("validator.urlPlaceholder"),value:z,onChange:e=>A(e.target.value),disabled:o}),s.jsx("p",{className:"text-xs text-muted-foreground",children:d("validator.corsWarning")}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(u,{variant:"secondary",onClick:oe,disabled:!z.trim(),size:"sm",children:d("validator.probeUrl")}),s.jsx(u,{variant:"ghost",size:"sm",onClick:he,children:d("validator.loadSample")})]}),W&&s.jsxs("div",{className:"rounded-2xl border border-dashed border-border p-4 text-sm text-muted-foreground",children:[s.jsxs("p",{children:[s.jsxs("strong",{children:[d("validator.metadata.type"),":"]})," ",W.contentType||d("validator.metadata.unknown")]}),s.jsxs("p",{children:[s.jsxs("strong",{children:[d("validator.metadata.size"),":"]})," ",W.size?`${Math.round(Number(W.size)/1024)} KB`:d("validator.metadata.unknown")]})]}),G&&s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[s.jsx(U,{className:"h-4 w-4"}),G]})]})}),s.jsx($,{value:"upload",className:"border-0 p-0 pt-4",children:Z&&!X.isUploading?s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border/70 bg-muted/30 px-4 py-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:s.jsx(R,{className:"h-5 w-5 text-primary"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium",children:Z}),s.jsx("span",{className:"text-xs text-muted-foreground",children:d("validator.fileLoaded")})]})]}),s.jsx(u,{variant:"ghost",size:"icon",onClick:ue,className:"h-8 w-8 text-muted-foreground hover:text-destructive","aria-label":d("common.clear"),children:s.jsx(B,{className:"h-4 w-4"})})]})}):X.isUploading?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl border border-border/70 bg-muted/30 px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:s.jsx(E,{className:"h-5 w-5 text-primary animate-pulse"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium",children:Z}),s.jsx("span",{className:"text-xs text-muted-foreground",children:d("validator.uploading")})]})]}),s.jsx(u,{variant:"ghost",size:"sm",onClick:()=>{re.current=!0,ee(null)},className:"text-muted-foreground hover:text-destructive",children:d("validator.cancelUpload")})]}),s.jsx(O,{value:X.progress,className:"h-2"}),s.jsx("div",{className:"mt-2 flex items-center justify-between",children:s.jsxs("span",{className:"text-xs text-muted-foreground",children:[X.progress,"%"]})})]}),X.error&&s.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[s.jsx(U,{className:"h-4 w-4"}),X.error]})]}):s.jsxs("div",{...me(),className:i("cursor-pointer rounded-2xl border-2 border-dashed transition-colors",pe?"border-primary bg-primary/5":"border-border/70 hover:border-primary/50 hover:bg-muted/30"),children:[s.jsx("input",{...xe()}),s.jsxs("div",{className:"flex flex-col items-center gap-4 px-6 py-12 text-center",children:[s.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:s.jsx(E,{className:"h-8 w-8 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-base font-medium text-foreground",children:d(pe?"validator.dropActive":"validator.dropInactive")}),s.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:d("validator.dropSubtitle")})]})]})]})})]}),s.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card/70 p-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:d("validator.currentProfile")}),s.jsxs("p",{className:"font-semibold text-foreground",children:[d(`profiles.names.${se.profile}.${se.version}`,{defaultValue:se.profile})," Â· ",se.branch]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(u,{variant:"ghost",onClick:he,disabled:o,children:d("validator.loadSample")}),s.jsx(u,{onClick:async()=>{let e=h,s=null;const a={url:"url"===x?z:void 0,contentType:s||W?.contentType||null};if("url"===x){if(!z.trim())return;try{const r=await fetch(z);if(!r.ok)throw new Error(`HTTP error ${r.status}`);s=r.headers.get("content-type"),a.contentType=s||W?.contentType||null,e=await r.text()}catch(l){return void K(d("validator.urlError"))}}if("upload"===x&&!h.trim())return;let t=null;try{if(t=g.detectFormat(e,a.url,a.contentType),"text/turtle"!==t&&"turtle"!==t){const a=await g.normalizeToTurtle(e,{format:t,url:"url"===x?z:void 0,contentType:s||W?.contentType||null});e=a,t="text/turtle","url"!==x&&f(a)}}catch(l){t=t||"text/turtle"}if("paste"!==x||!te.hasData)try{const s=t||g.detectFormat(e,a.url,a.contentType),r=await g.parseRDF(e,s),l=ne(r);le({...l,hasData:!0})}catch(l){}r(e,se)},disabled:ve,className:"min-w-[160px]",children:o?s.jsxs(s.Fragment,{children:[s.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),d("common.validating")]}):d("common.validate")})]})]})]})]})]})};export{G as default};

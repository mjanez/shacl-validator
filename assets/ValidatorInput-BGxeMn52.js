const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-DDTMawMR.js","assets/charts-BadQMOzK.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-D3Wn7UNJ.js";import{r as t,W as ss}from"./charts-BadQMOzK.js";import{u as Be,T as rs}from"./textarea-C4BlFwEd.js";import{c as L,u as ee,a as re,T as Z,b as O,d as W,B as k,e as J,D as ne,f as oe,g as ie,h as de,i as Me,_ as ts,j as as,R as A}from"./index-BpK-bX0a.js";import{C as fe,a as je,b as ge,c as ve,d as be,e as ls}from"./card-Cn_z-V2r.js";import{B as ue}from"./badge-dAaUKb_p.js";import{I as X,d as ce,e as xe,T as pe,f as q,g as he,h as ns,i as ze,j as H,k as os,c as is,l as ds,m as cs,n as ms,E as us,o as me,X as xs}from"./icons-oLbWWKZ2.js";import{I as Ie}from"./input-BJJ0IB77.js";import{T as Re,a as Ue,b as G,c as K}from"./tabs-BG4oIbrT.js";import"./ui-kIuPQhpd.js";import"./rdf-DktVfMyT.js";const Y=t.forwardRef(({className:i,...m},s)=>e.jsx("label",{ref:s,className:L("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",i),...m}));Y.displayName="Label";const ps=({selectedProfile:i,onProfileChange:m,disabled:s=!1})=>{const{t:n}=ee(),S=re.profiles,x=(l,d)=>{const y=S[l]?.versions?.[d];return y?n(`profiles.names.${l}.${d}`,{defaultValue:y.name}):l},C=(l,d)=>n(`profiles.branches.${l}`,{defaultValue:d||l}),j=l=>{const d=S[l].defaultVersion,b=S[l].defaultBranch||"main";m({profile:l,version:d,branch:b,mode:"predefined"})},T=l=>{m({...i,version:l})},B=l=>{m({...i,branch:l})},w=S[i.profile],F=w?.versions[i.version],M=w?Object.keys(w.versions).sort().reverse():[],v=w?.branches||{},D=Object.keys(v).length>0,N=i.branch||w?.defaultBranch||"main",I=(l,d)=>e.jsxs(k,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:s,children:[e.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[d&&e.jsx("img",{src:d,alt:"",className:"h-6 w-6"}),l]}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]}),V=(l,d)=>e.jsxs(k,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:s||d,children:[e.jsx("span",{className:"text-sm font-medium",children:l}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]});return e.jsxs(fe,{className:"border border-border/70 bg-card",children:[e.jsxs(je,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{className:"text-base",children:n("validator.selectProfile")}),e.jsx(ve,{children:n("validator.workspaceSubtitle")})]}),F&&e.jsx(Z,{children:e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",asChild:!0,"aria-label":n("validator.profileInfo")??"Profile documentation",children:e.jsx("a",{href:F.url,target:"_blank",rel:"noreferrer",className:"text-muted-foreground",children:e.jsx(X,{className:"h-5 w-5"})})})}),e.jsx(J,{children:n("validator.profileInfo")})]})})]}),e.jsxs(be,{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Y,{children:n("validator.selectProfile")}),e.jsxs(ne,{modal:!1,children:[e.jsx(oe,{asChild:!0,children:I(x(i.profile,i.version),F?.icon)}),e.jsx(ie,{className:"min-w-[260px]",children:Object.keys(S).map(l=>{const d=S[l],b=d.versions[d.defaultVersion];return e.jsxs(de,{onSelect:y=>{y.preventDefault(),j(l)},className:"flex items-center gap-3",children:[b.icon&&e.jsx("img",{src:b.icon,alt:"",className:"h-5 w-5"}),e.jsx("span",{children:x(l,d.defaultVersion)})]},l)})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Y,{children:n("validator.version")}),e.jsxs(ne,{modal:!1,children:[e.jsx(oe,{asChild:!0,children:V(i.version,M.length<=1)}),e.jsx(ie,{children:M.map(l=>e.jsxs(de,{onSelect:d=>{d.preventDefault(),T(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:l}),i.version===l&&e.jsx(ce,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]}),D&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Y,{children:n("validator.branch")}),e.jsxs(ne,{modal:!1,children:[e.jsx(oe,{asChild:!0,children:V(C(N,v[N]),!1)}),e.jsx(ie,{children:Object.entries(v).map(([l,d])=>e.jsxs(de,{onSelect:b=>{b.preventDefault(),B(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:C(l,d)}),N===l&&e.jsx(ce,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]})]}),e.jsxs(ls,{className:"flex flex-wrap items-center justify-between gap-4 border-t border-border/60 bg-muted/30 px-6 py-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ue,{variant:"success",className:"uppercase tracking-tight",children:n("validator.currentProfile")}),e.jsx("span",{className:"text-xs text-muted-foreground/80",children:n("validator.profileReadyHint")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-muted-foreground",children:[e.jsx(ce,{className:"h-4 w-4 text-emerald-500","aria-hidden":"true"}),e.jsxs("span",{className:"font-medium text-foreground",children:[n("validator.validatingAgainst"),": ",e.jsx("span",{className:"text-muted-foreground",children:x(i.profile,i.version)})]})]})]})]})},hs=({shaclFiles:i,onChange:m})=>{const{t:s}=ee(),[n,S]=t.useState("paste"),[x,C]=t.useState(""),[j,T]=t.useState(""),[B,w]=t.useState(null),[F,M]=t.useState(!1),v=()=>`shacl-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,D=t.useCallback(o=>{m([...i,o])},[i,m]),N=t.useCallback(o=>{m(i.filter(E=>E.id!==o))},[i,m]),I=()=>{if(!x.trim())return;const o={id:v(),content:x,source:"paste"};D(o),C("")},V=async()=>{if(j.trim()){M(!0),w(null);try{const o=await fetch(j);if(!o.ok)throw new Error(`HTTP ${o.status}`);const E=await o.text(),R={id:v(),content:E,source:"url",url:j};D(R),T("")}catch(o){w(s("validator.urlError")),console.error("Failed to load SHACL from URL:",o)}finally{M(!1)}}},l=t.useCallback(async o=>{for(const E of o)try{const R=await E.text(),U={id:v(),content:R,source:"upload"};D(U)}catch(R){console.error(`Failed to read file ${E.name}:`,R)}},[D]),{getRootProps:d,getInputProps:b,isDragActive:y}=Be({onDrop:l,accept:{"text/turtle":[".ttl",".shacl"],"application/rdf+xml":[".rdf",".xml"],"application/ld+json":[".jsonld"]},multiple:!0});return e.jsxs(fe,{className:"border-dashed border-2 border-primary/30",children:[e.jsx(je,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),s("profiles.manager.title")]}),e.jsx(ve,{children:s("profiles.manager.description")})]}),i.length>0&&e.jsxs(ue,{variant:"outline",children:[i.length," ",s("profiles.manager.filesLoaded")]})]})}),e.jsxs(be,{className:"space-y-4",children:[i.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:s("profiles.manager.loadedFiles")}),e.jsx("div",{className:"space-y-2",children:i.map((o,E)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s("profiles.manager.file")," #",E+1,o.url&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",new URL(o.url).hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ue,{variant:"outline",className:"text-xs",children:[o.source==="paste"&&e.jsx(pe,{className:"h-3 w-3 mr-1"}),o.source==="upload"&&e.jsx(q,{className:"h-3 w-3 mr-1"}),o.source==="url"&&e.jsx(he,{className:"h-3 w-3 mr-1"}),s(`profiles.manager.source.${o.source}`)]}),e.jsxs("span",{children:[(o.content.length/1024).toFixed(1)," KB"]})]})]})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>N(o.id),className:"shrink-0",children:e.jsx(ns,{className:"h-4 w-4"})})]},o.id))})]}),e.jsxs(Re,{value:n,onValueChange:o=>S(o),className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-3",children:[e.jsxs(G,{value:"paste",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.paste")]}),e.jsxs(G,{value:"upload",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.upload")]}),e.jsxs(G,{value:"url",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.url")]})]}),e.jsxs(K,{value:"paste",className:"space-y-3 mt-4",children:[e.jsx(rs,{placeholder:s("profiles.manager.pastePlaceholder"),value:x,onChange:o=>C(o.target.value),className:"min-h-[200px] font-mono text-sm"}),e.jsxs(k,{onClick:I,disabled:!x.trim(),className:"w-full",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),s("profiles.manager.addFile")]})]}),e.jsx(K,{value:"upload",className:"mt-4",children:e.jsxs("div",{...d(),className:L("flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 text-center transition-colors cursor-pointer",y?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-muted/30"),children:[e.jsx("input",{...b()}),e.jsx(q,{className:L("h-12 w-12 mb-4",y?"text-primary":"text-muted-foreground")}),e.jsx("p",{className:"text-sm font-medium",children:s(y?"profiles.manager.dropActive":"profiles.manager.dropInactive")}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:s("profiles.manager.dropHint")})]})}),e.jsxs(K,{value:"url",className:"space-y-3 mt-4",children:[e.jsx(Ie,{placeholder:s("profiles.manager.urlPlaceholder"),value:j,onChange:o=>{T(o.target.value),w(null)}}),B&&e.jsxs("div",{className:"flex items-start gap-2 rounded-lg border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800 dark:border-yellow-900 dark:bg-yellow-950 dark:text-yellow-200",children:[e.jsx(H,{className:"h-4 w-4 mt-0.5 shrink-0"}),e.jsx("p",{children:B})]}),e.jsx(k,{onClick:V,disabled:!j.trim()||F,className:"w-full",children:F?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),s("common.loading")]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),s("profiles.manager.loadUrl")]})})]})]})]})]})},fs=({mode:i,onChange:m,disabled:s=!1})=>{const{t:n}=ee();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Y,{children:n("validator.validationMode")}),e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-border bg-muted/30 p-1",children:[e.jsxs("button",{onClick:()=>m("predefined"),disabled:s,className:L("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",i==="predefined"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx(os,{className:"h-4 w-4"}),n("validator.mode.predefined")]}),e.jsxs("button",{onClick:()=>m("custom"),disabled:s,className:L("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",i==="custom"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx(is,{className:"h-4 w-4"}),n("validator.mode.custom")]})]})]})},Ve=t.forwardRef(({className:i,value:m=0,...s},n)=>e.jsx("div",{ref:n,className:L("relative h-2 w-full overflow-hidden rounded-full bg-muted",i),...s,children:e.jsx("div",{className:"h-full w-full flex-1 rounded-full bg-gradient-to-r from-primary to-accent transition-all",style:{transform:`translateX(-${100-Math.min(100,Math.max(0,m))}%)`}})}));Ve.displayName="Progress";function De({className:i,...m}){return e.jsx("div",{className:L("animate-pulse rounded-md bg-muted/60",i),...m})}const Ee=ss.lazy(()=>ts(()=>import("./monaco-DDTMawMR.js"),__vite__mapDeps([0,1]))),js=({value:i,onChange:m,jsonPreview:s})=>{const{t:n}=ee(),{theme:S}=Me(),[x,C]=t.useState(!1),T=S==="dark"?"vs-dark":"vs-light",B="flex min-h-[57px] items-center justify-between border-b border-border px-4 py-2",w=async()=>{if(s)try{await navigator.clipboard.writeText(s),C(!0),setTimeout(()=>C(!1),2e3)}catch(F){console.error("Failed to copy:",F)}};return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsxs("div",{className:`${B} text-xs text-muted-foreground`,children:[e.jsx("span",{className:"uppercase tracking-wide",children:n("validator.pasteText")}),e.jsx(Z,{children:e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(H,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:e.jsx("p",{className:"text-xs",children:n("validator.supportedFormats")})})]})})]}),e.jsx("div",{className:"h-[420px]",children:e.jsx(t.Suspense,{fallback:e.jsx(De,{className:"h-full w-full rounded-none"}),children:e.jsx(Ee,{height:"100%",defaultLanguage:"turtle",theme:T,value:i,onChange:F=>m(F||""),options:{minimap:{enabled:!1},wordWrap:"on",fontSize:14,fontFamily:"JetBrains Mono",scrollBeyondLastLine:!1,automaticLayout:!0,renderLineHighlight:"none"}})})})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsxs("div",{className:B,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:n("validator.previewLabel")}),e.jsx("span",{className:"rounded-full bg-primary/10 px-2 py-1 text-[10px] font-medium text-primary",children:n("validator.jsonPreview")})]}),s&&e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:w,"aria-label":n("validator.copyJsonLd"),children:x?e.jsx(ds,{className:"h-3.5 w-3.5 text-green-600"}):e.jsx(cs,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:n(x?"validator.copied":"validator.copyJsonLd")})]}),e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>window.open("https://json-ld.org/","_blank","noopener,noreferrer"),"aria-label":n("validator.jsonLdHelp"),children:e.jsx(ms,{className:"h-3.5 w-3.5"})})}),e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[n("validator.jsonLdHelp"),e.jsx(us,{className:"h-3 w-3"})]})})]})]})})]}),e.jsx("div",{className:"h-[420px]",children:s?e.jsx(t.Suspense,{fallback:e.jsx(De,{className:"h-full w-full rounded-none"}),children:e.jsx(Ee,{height:"100%",defaultLanguage:"json",theme:T,value:s,options:{readOnly:!0,minimap:{enabled:!1},wordWrap:"on",fontSize:13,fontFamily:"JetBrains Mono",automaticLayout:!0,renderLineHighlight:"none"}})}):e.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:n("validator.previewEmpty")})})})]})]})},gs=2*1024,vs=.4,Le=256*1024,se={datasets:0,dataServices:0,distributions:0,hasData:!1},Es=({onValidate:i,isLoading:m})=>{const{t:s}=ee(),{setRdfStats:n}=Me(),[S]=as(),[x,C]=t.useState("paste"),[j,T]=t.useState(""),[B,w]=t.useState(""),[F,M]=t.useState(""),[v,D]=t.useState(""),[N,I]=t.useState(null),[V,l]=t.useState(null),[d,b]=t.useState({progress:0,isUploading:!1,error:null}),[y,o]=t.useState(null),[E,R]=t.useState(!1),[U,te]=t.useState(null),[ae,Ne]=t.useState(null),[p,we]=t.useState({profile:"dcat_ap_es",version:"1.0.0",branch:"main",mode:"predefined"}),[_,Pe]=t.useState([]),le=t.useRef(!1),[$,Q]=t.useState(se);t.useEffect(()=>{m||Ne(null)},[m]),t.useEffect(()=>{const r=S.get("sample");if(r){const h=re.profiles[p.profile]?.versions[p.version]?.samples?.[r];h&&(D(h),C("url"))}},[S,p]),t.useEffect(()=>{if(!j.trim()){w(""),M(""),Q({...se});return}let r=!1;return(async()=>{try{const c=A.detectFormat(j);if(c==="application/ld+json"||c==="application/json"){w(""),M(""),Q({...se});return}const u=await A.parseRDF(j,c);if(r)return;const h=await A.normalizeToTurtle(j,{format:c});if(r)return;w(h),M(JSON.stringify(Ae(u),null,2));const g=ye(u);Q({...g,hasData:!0})}catch(c){console.error("Preview error",c),Q({...se})}})(),()=>{r=!0}},[j]);const Ae=r=>{const a={},c=r.getQuads(null,null,null,null);for(const u of c){const h=u.subject.value;a[h]||(a[h]={"@id":h});const g=u.predicate.value,f=u.object.termType==="Literal"?{"@value":u.object.value,"@type":u.object.datatype?.value,"@language":u.object.language||void 0}:{"@id":u.object.value};a[h][g]?a[h][g]=Array.isArray(a[h][g])?[...a[h][g],f]:[a[h][g],f]:a[h][g]=f}return Object.values(a)},ye=r=>{const a="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",c="http://www.w3.org/ns/dcat#Dataset",u="http://www.w3.org/ns/dcat#DataService",h="http://www.w3.org/ns/dcat#Distribution",g={datasets:new Set,dataServices:new Set,distributions:new Set},f=r.getQuads(null,null,null,null);for(const z of f){if(z.predicate.value!==a)continue;const P=z.subject.value;switch(z.object.value){case c:g.datasets.add(P);break;case u:g.dataServices.add(P);break;case h:g.distributions.add(P);break}}return{datasets:g.datasets.size,dataServices:g.dataServices.size,distributions:g.distributions.size}},ke=r=>r<1024?`${r} B`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`,Ce=r=>{const a=r/1048576;return Math.max(1,Math.ceil(a*vs))},_e=()=>{if(U){const r=new Blob([U.payload]).size;Ne({size:r}),i(U.payload,U.profile),te(null),R(!1)}},$e=()=>{te(null),R(!1)},He=async()=>{let r=j,a=null;const c={url:x==="url"?v:void 0,contentType:a||N?.contentType||null};if(x==="url"){if(!v.trim())return;try{const f=await fetch(v);if(!f.ok)throw new Error(`HTTP error ${f.status}`);a=f.headers.get("content-type"),c.contentType=a||N?.contentType||null,r=await f.text()}catch(f){console.error(f),l(s("validator.urlError"));return}}if(x==="upload"&&!j.trim())return;let u=null;try{if(u=A.detectFormat(r,c.url,c.contentType),u!=="text/turtle"&&u!=="turtle"){const f=await A.normalizeToTurtle(r,{format:u,url:x==="url"?v:void 0,contentType:a||N?.contentType||null});r=f,u="text/turtle",x!=="url"&&T(f)}}catch(f){console.error("Normalization error",f),u=u||"text/turtle"}if(x!=="paste"||!$.hasData)try{const f=u||A.detectFormat(r,c.url,c.contentType);if(f!=="application/ld+json"){const z=await A.parseRDF(r,f),P=ye(z);Q({...P,hasData:!0})}}catch(f){console.warn("Failed to derive RDF stats",f)}const h={...p,customShacl:p.mode==="custom"?_:void 0};if(new Blob([r]).size/1024>gs){te({payload:r,profile:h}),R(!0);return}i(r,h)},Se=t.useCallback(async r=>{if(!r.trim()){I(null);return}l(null);try{const a=await fetch(r,{method:"HEAD"});if(a.ok){I({size:a.headers.get("content-length")||void 0,contentType:a.headers.get("content-type")||void 0});return}}catch{console.warn("HEAD request failed, falling back to GET metadata")}try{const a=await fetch(r,{method:"GET"});if(!a.ok)throw new Error("Failed metadata fetch");I({size:a.headers.get("content-length")||void 0,contentType:a.headers.get("content-type")||void 0})}catch(a){console.error(a),I(null)}},[]);t.useEffect(()=>{if(!v.trim()){I(null);return}const r=setTimeout(()=>{Se(v)},500);return()=>clearTimeout(r)},[v,Se]);const Te=t.useCallback(r=>new Promise((a,c)=>{const u=new FileReader;let h=0,g="";le.current=!1,b({progress:0,isUploading:!0,error:null});const f=()=>{if(le.current){b({progress:0,isUploading:!1,error:s("validator.uploadCancelled")}),c(new Error("Upload cancelled"));return}const z=r.slice(h,h+Le);u.readAsText(z)};u.onload=z=>{g+=z.target?.result,h+=Le;const P=Math.min(100,Math.round(h/r.size*100));b(es=>({...es,progress:P})),h<r.size?f():(b({progress:100,isUploading:!1,error:null}),a(g))},u.onerror=()=>{const z=u.error?.message||"Upload error";b({progress:0,isUploading:!1,error:z}),o(null),c(u.error||new Error(z))},f()}),[s]),Oe=t.useCallback(async r=>{if(!r.length)return;const a=r[0];try{const c=await Te(a);T(c),C("upload"),o(a.name)}catch(c){console.error(c),o(null)}},[Te]),We=t.useCallback(r=>{if(r.length>0){const c=r[0].file.name,u=c.substring(c.lastIndexOf(".")).toLowerCase();b({progress:0,isUploading:!1,error:s("validator.unsupportedFormatError",{extension:u})})}},[s]),Je=t.useCallback(()=>{T(""),o(null),b({progress:0,isUploading:!1,error:null})},[]),qe=()=>{le.current=!0,o(null)},{getRootProps:Ge,getInputProps:Ke,isDragActive:Fe}=Be({accept:{"text/turtle":[".ttl"],"text/n3":[".n3"],"application/rdf+xml":[".rdf",".xml"],"application/ld+json":[".jsonld",".json"]},multiple:!1,onDropAccepted:Oe,onDropRejected:We}),Qe=()=>{let c=re.profiles[p.profile]?.versions[p.version]?.sampleUrl;c&&p.branch&&(c=c.replace("{branch}",p.branch)),c&&(D(c),C("url"))};t.useEffect(()=>{const r=re.profiles;if(!$.hasData){n(null);return}const a=r[p.profile]?.versions?.[p.version]?.icon;n({datasets:$.datasets,dataServices:$.dataServices,distributions:$.distributions,profileId:p.profile,profileVersion:p.version,profileBranch:p.branch,profileIcon:a})},[$,p,n]),t.useEffect(()=>()=>n(null),[n]);const Xe=t.useMemo(()=>{const r={success:"bg-emerald-500/15 text-emerald-600 dark:text-emerald-300",info:"bg-sky-500/15 text-sky-700 dark:text-sky-200",progress:"bg-primary/15 text-primary"};return[{key:"paste",title:s("validator.actions.pasteTitle"),description:s("validator.actions.pasteDescription"),icon:pe,active:x==="paste",status:j?{label:s("validator.actions.ready"),style:r.success}:void 0},{key:"upload",title:s("validator.actions.uploadTitle"),description:s("validator.actions.uploadDescription"),icon:q,active:x==="upload",status:d.isUploading?{label:`${d.progress}%`,style:r.progress}:y?{label:y,style:r.info}:void 0},{key:"url",title:s("validator.actions.urlTitle"),description:s("validator.actions.urlDescription"),icon:he,active:x==="url",status:N?.contentType?{label:N.contentType.split(";")[0],style:r.info}:void 0}]},[x,j,N,d,y,s]),Ye=t.useMemo(()=>m||p.mode==="custom"&&_.length===0?!0:x==="paste"?!j.trim():x==="url"?!v.trim():x==="upload"?!j.trim():!0,[x,j,v,m,p.mode,_.length]),Ze=r=>{we(a=>({...a,mode:r}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(fs,{mode:p.mode,onChange:Ze,disabled:m}),p.mode==="predefined"?e.jsx(ps,{selectedProfile:p,onProfileChange:we,disabled:m}):e.jsx(hs,{shaclFiles:_,onChange:Pe}),e.jsxs(fe,{children:[e.jsxs(je,{children:[e.jsx(ge,{children:s("validator.workspaceTitle")}),e.jsx(ve,{children:s("validator.workspaceSubtitle")})]}),e.jsxs(be,{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Xe.map(r=>e.jsxs("button",{onClick:()=>C(r.key),className:L("rounded-2xl border p-4 text-left transition-all hover:border-primary hover:shadow-md",r.active?"border-primary/50 bg-primary/5":"border-border"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.icon,{className:"h-5 w-5 text-primary","aria-hidden":"true"}),r.status&&e.jsx("span",{className:L("rounded-full px-2 py-0.5 text-xs font-semibold",r.status.style),children:r.status.label})]}),e.jsx("p",{className:"mt-3 font-semibold text-sm",children:r.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.description})]},r.key))}),e.jsxs(Re,{value:x,onValueChange:r=>C(r),children:[e.jsxs(Ue,{className:"w-full gap-2",children:[e.jsx(G,{value:"paste",children:s("validator.pasteText")}),e.jsx(G,{value:"upload",children:s("validator.uploadTab")}),e.jsx(G,{value:"url",children:s("validator.url")})]}),e.jsx(K,{value:"paste",className:"border-0 p-0",children:e.jsx(t.Suspense,{fallback:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(me,{className:"h-4 w-4 animate-spin"})," ",s("validator.loadingEditor")]}),children:e.jsx(js,{value:j,onChange:T,normalizedContent:B,jsonPreview:F})})}),e.jsx(K,{value:"url",className:"border-0 p-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ie,{type:"url",placeholder:s("validator.urlPlaceholder"),value:v,onChange:r=>D(r.target.value),disabled:m}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Z,{children:e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-foreground transition-colors",children:[e.jsx(X,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:s("validator.supportedFormats")})]})}),e.jsx(J,{children:e.jsx("p",{className:"text-xs",children:s("validator.supportedFormats")})})]})}),e.jsx("span",{className:"text-muted-foreground/60",children:"|"}),e.jsx("span",{children:s("validator.corsWarning")})]}),N&&e.jsxs("div",{className:"rounded-2xl border border-dashed border-border p-4 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[s("validator.metadata.type"),":"]})," ",N.contentType||s("validator.metadata.unknown")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[s("validator.metadata.size"),":"]})," ",N.size?`${Math.round(Number(N.size)/1024)} KB`:s("validator.metadata.unknown")]})]}),V&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(H,{className:"h-4 w-4"}),V]})]})}),e.jsx(K,{value:"upload",className:"border-0 p-0 pt-4",children:y&&!d.isUploading?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border/70 bg-muted/30 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(xe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:y}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s("validator.fileLoaded")})]})]}),e.jsx(k,{variant:"ghost",size:"icon",onClick:Je,className:"h-8 w-8 text-muted-foreground hover:text-destructive","aria-label":s("common.clear"),children:e.jsx(xs,{className:"h-4 w-4"})})]})}):d.isUploading?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-border/70 bg-muted/30 px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(q,{className:"h-5 w-5 text-primary animate-pulse"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:y}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s("validator.uploading")})]})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:qe,className:"text-muted-foreground hover:text-destructive",children:s("validator.cancelUpload")})]}),e.jsx(Ve,{value:d.progress,className:"h-2"}),e.jsx("div",{className:"mt-2 flex items-center justify-between",children:e.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.progress,"%"]})})]}),d.error&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(H,{className:"h-4 w-4"}),d.error]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{...Ge(),className:L("cursor-pointer rounded-2xl border-2 border-dashed transition-colors",Fe?"border-primary bg-primary/5":"border-border/70 hover:border-primary/50 hover:bg-muted/30"),children:[e.jsx("input",{...Ke()}),e.jsxs("div",{className:"flex flex-col items-center gap-4 px-6 py-12 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(q,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:s(Fe?"validator.dropActive":"validator.dropInactive")}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s("validator.dropSubtitle")}),e.jsx(Z,{children:e.jsxs(O,{children:[e.jsx(W,{asChild:!0,children:e.jsxs("button",{className:"mt-2 inline-flex items-center gap-1 text-xs text-muted-foreground/80 hover:text-muted-foreground transition-colors",children:[e.jsx(X,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:s("validator.supportedFormats")})]})}),e.jsx(J,{children:e.jsx("p",{className:"text-xs",children:s("validator.supportedFormats")})})]})})]})]})]}),d.error&&e.jsx("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-destructive"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:d.error}),e.jsxs("p",{className:"text-xs text-destructive/80",children:[s("validator.converterHint")," ",e.jsx("a",{href:"https://www.easyrdf.org/converter",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-destructive",children:"EasyRDF Converter"})]})]})]})})]})})]}),E&&U&&e.jsx("div",{className:"rounded-2xl border border-amber-500/40 bg-amber-500/10 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-amber-500"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-600 dark:text-amber-400",children:s("validator.largeFile.title")}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s("validator.largeFile.message",{size:ke(new Blob([U.payload]).size)})})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-amber-500/10 p-2",children:[e.jsx(X,{className:"h-4 w-4 text-amber-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("validator.largeFile.tip")})]}),e.jsx("p",{className:"text-xs font-medium text-amber-600 dark:text-amber-400",children:s("validator.largeFile.estimatedTime",{minutes:Ce(new Blob([U.payload]).size)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",size:"sm",onClick:$e,children:s("validator.largeFile.cancel")}),e.jsx(k,{size:"sm",onClick:_e,className:"bg-amber-600 hover:bg-amber-700",children:s("validator.largeFile.proceed")})]})]})]})}),m&&ae&&e.jsx("div",{className:"rounded-2xl border border-sky-500/40 bg-sky-500/10 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(me,{className:"mt-0.5 h-5 w-5 flex-shrink-0 animate-spin text-sky-500"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-sky-600 dark:text-sky-400",children:[s("common.validating")," (",ke(ae.size),")"]}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s("validator.largeFile.estimatedTime",{minutes:Ce(ae.size)})})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-sky-500/10 p-2",children:[e.jsx(X,{className:"h-4 w-4 text-sky-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("validator.largeFile.tip")})]})]})]})}),e.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card/70 p-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("validator.currentProfile")}),e.jsx("p",{className:"font-semibold text-foreground",children:p.mode==="custom"?`${s("validator.mode.custom")} (${_.length} ${_.length===1?"file":"files"})`:`${s(`profiles.names.${p.profile}.${p.version}`,{defaultValue:p.profile})} Â· ${p.branch}`})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.mode==="predefined"&&e.jsx(k,{variant:"ghost",onClick:Qe,disabled:m,children:s("validator.loadSample")}),e.jsx(k,{onClick:He,disabled:Ye,className:"min-w-[160px]",children:m?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}),s("common.validating")]}):s("common.validate")})]})]})]})]})]})};export{Es as default};

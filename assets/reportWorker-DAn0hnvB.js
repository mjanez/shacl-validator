(function(){"use strict";const ye=Symbol("Comlink.proxy"),Je=Symbol("Comlink.endpoint"),Ze=Symbol("Comlink.releaseProxy"),ce=Symbol("Comlink.finalizer"),K=Symbol("Comlink.thrown"),we=o=>typeof o=="object"&&o!==null||typeof o=="function",Xe={canHandle:o=>we(o)&&o[ye],serialize(o){const{port1:r,port2:a}=new MessageChannel;return fe(o,r),[a,[a]]},deserialize(o){return o.start(),tt(o)}},Ye={canHandle:o=>we(o)&&K in o,serialize({value:o}){let r;return o instanceof Error?r={isError:!0,value:{message:o.message,name:o.name,stack:o.stack}}:r={isError:!1,value:o},[r,[]]},deserialize(o){throw o.isError?Object.assign(new Error(o.value.message),o.value):o.value}},me=new Map([["proxy",Xe],["throw",Ye]]);function Ke(o,r){for(const a of o)if(r===a||a==="*"||a instanceof RegExp&&a.test(r))return!0;return!1}function fe(o,r=globalThis,a=["*"]){r.addEventListener("message",function u(f){if(!f||!f.data)return;if(!Ke(a,f.origin)){console.warn(`Invalid origin '${f.origin}' for comlink proxy`);return}const{id:p,type:d,path:s}=Object.assign({path:[]},f.data),w=(f.data.argumentList||[]).map(O);let b;try{const E=s.slice(0,-1).reduce((y,g)=>y[g],o),x=s.reduce((y,g)=>y[g],o);switch(d){case"GET":b=x;break;case"SET":E[s.slice(-1)[0]]=O(f.data.value),b=!0;break;case"APPLY":b=x.apply(E,w);break;case"CONSTRUCT":{const y=new x(...w);b=at(y)}break;case"ENDPOINT":{const{port1:y,port2:g}=new MessageChannel;fe(o,g),b=st(y,[y])}break;case"RELEASE":b=void 0;break;default:return}}catch(E){b={value:E,[K]:0}}Promise.resolve(b).catch(E=>({value:E,[K]:0})).then(E=>{const[x,y]=ie(E);r.postMessage(Object.assign(Object.assign({},x),{id:p}),y),d==="RELEASE"&&(r.removeEventListener("message",u),be(r),ce in o&&typeof o[ce]=="function"&&o[ce]())}).catch(E=>{const[x,y]=ie({value:new TypeError("Unserializable return value"),[K]:0});r.postMessage(Object.assign(Object.assign({},x),{id:p}),y)})}),r.start&&r.start()}function et(o){return o.constructor.name==="MessagePort"}function be(o){et(o)&&o.close()}function tt(o,r){const a=new Map;return o.addEventListener("message",function(f){const{data:p}=f;if(!p||!p.id)return;const d=a.get(p.id);if(d)try{d(p)}finally{a.delete(p.id)}}),le(o,a,[],r)}function ee(o){if(o)throw new Error("Proxy has been released and is not useable")}function Ee(o){return v(o,new Map,{type:"RELEASE"}).then(()=>{be(o)})}const te=new WeakMap,re="FinalizationRegistry"in globalThis&&new FinalizationRegistry(o=>{const r=(te.get(o)||0)-1;te.set(o,r),r===0&&Ee(o)});function rt(o,r){const a=(te.get(r)||0)+1;te.set(r,a),re&&re.register(o,r,o)}function it(o){re&&re.unregister(o)}function le(o,r,a=[],u=function(){}){let f=!1;const p=new Proxy(u,{get(d,s){if(ee(f),s===Ze)return()=>{it(p),Ee(o),r.clear(),f=!0};if(s==="then"){if(a.length===0)return{then:()=>p};const w=v(o,r,{type:"GET",path:a.map(b=>b.toString())}).then(O);return w.then.bind(w)}return le(o,r,[...a,s])},set(d,s,w){ee(f);const[b,E]=ie(w);return v(o,r,{type:"SET",path:[...a,s].map(x=>x.toString()),value:b},E).then(O)},apply(d,s,w){ee(f);const b=a[a.length-1];if(b===Je)return v(o,r,{type:"ENDPOINT"}).then(O);if(b==="bind")return le(o,r,a.slice(0,-1));const[E,x]=Ie(w);return v(o,r,{type:"APPLY",path:a.map(y=>y.toString()),argumentList:E},x).then(O)},construct(d,s){ee(f);const[w,b]=Ie(s);return v(o,r,{type:"CONSTRUCT",path:a.map(E=>E.toString()),argumentList:w},b).then(O)}});return rt(p,o),p}function nt(o){return Array.prototype.concat.apply([],o)}function Ie(o){const r=o.map(ie);return[r.map(a=>a[0]),nt(r.map(a=>a[1]))]}const Be=new WeakMap;function st(o,r){return Be.set(o,r),o}function at(o){return Object.assign(o,{[ye]:!0})}function ie(o){for(const[r,a]of me)if(a.canHandle(o)){const[u,f]=a.serialize(o);return[{type:"HANDLER",name:r,value:u},f]}return[{type:"RAW",value:o},Be.get(o)||[]]}function O(o){switch(o.type){case"HANDLER":return me.get(o.name).deserialize(o.value);case"RAW":return o.value}}function v(o,r,a,u){return new Promise(f=>{const p=ut();r.set(p,f),o.start&&o.start(),o.postMessage(Object.assign({id:p},a),u)})}function ut(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var de={},Q={},Fe;function ot(){if(Fe)return Q;Fe=1,Q.byteLength=s,Q.toByteArray=b,Q.fromByteArray=y;for(var o=[],r=[],a=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=u.length;f<p;++f)o[f]=u[f],r[u.charCodeAt(f)]=f;r[45]=62,r[95]=63;function d(g){var _=g.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=g.indexOf("=");I===-1&&(I=_);var m=I===_?0:4-I%4;return[I,m]}function s(g){var _=d(g),I=_[0],m=_[1];return(I+m)*3/4-m}function w(g,_,I){return(_+I)*3/4-I}function b(g){var _,I=d(g),m=I[0],R=I[1],B=new a(w(g,m,R)),j=0,D=R>0?m-4:m,S;for(S=0;S<D;S+=4)_=r[g.charCodeAt(S)]<<18|r[g.charCodeAt(S+1)]<<12|r[g.charCodeAt(S+2)]<<6|r[g.charCodeAt(S+3)],B[j++]=_>>16&255,B[j++]=_>>8&255,B[j++]=_&255;return R===2&&(_=r[g.charCodeAt(S)]<<2|r[g.charCodeAt(S+1)]>>4,B[j++]=_&255),R===1&&(_=r[g.charCodeAt(S)]<<10|r[g.charCodeAt(S+1)]<<4|r[g.charCodeAt(S+2)]>>2,B[j++]=_>>8&255,B[j++]=_&255),B}function E(g){return o[g>>18&63]+o[g>>12&63]+o[g>>6&63]+o[g&63]}function x(g,_,I){for(var m,R=[],B=_;B<I;B+=3)m=(g[B]<<16&16711680)+(g[B+1]<<8&65280)+(g[B+2]&255),R.push(E(m));return R.join("")}function y(g){for(var _,I=g.length,m=I%3,R=[],B=16383,j=0,D=I-m;j<D;j+=B)R.push(x(g,j,j+B>D?D:j+B));return m===1?(_=g[I-1],R.push(o[_>>2]+o[_<<4&63]+"==")):m===2&&(_=(g[I-2]<<8)+g[I-1],R.push(o[_>>10]+o[_>>4&63]+o[_<<2&63]+"=")),R.join("")}return Q}var ne={};var Re;function ht(){return Re||(Re=1,ne.read=function(o,r,a,u,f){var p,d,s=f*8-u-1,w=(1<<s)-1,b=w>>1,E=-7,x=a?f-1:0,y=a?-1:1,g=o[r+x];for(x+=y,p=g&(1<<-E)-1,g>>=-E,E+=s;E>0;p=p*256+o[r+x],x+=y,E-=8);for(d=p&(1<<-E)-1,p>>=-E,E+=u;E>0;d=d*256+o[r+x],x+=y,E-=8);if(p===0)p=1-b;else{if(p===w)return d?NaN:(g?-1:1)*(1/0);d=d+Math.pow(2,u),p=p-b}return(g?-1:1)*d*Math.pow(2,p-u)},ne.write=function(o,r,a,u,f,p){var d,s,w,b=p*8-f-1,E=(1<<b)-1,x=E>>1,y=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=u?0:p-1,_=u?1:-1,I=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,d=E):(d=Math.floor(Math.log(r)/Math.LN2),r*(w=Math.pow(2,-d))<1&&(d--,w*=2),d+x>=1?r+=y/w:r+=y*Math.pow(2,1-x),r*w>=2&&(d++,w/=2),d+x>=E?(s=0,d=E):d+x>=1?(s=(r*w-1)*Math.pow(2,f),d=d+x):(s=r*Math.pow(2,x-1)*Math.pow(2,f),d=0));f>=8;o[a+g]=s&255,g+=_,s/=256,f-=8);for(d=d<<f|s,b+=f;b>0;o[a+g]=d&255,g+=_,d/=256,b-=8);o[a+g-_]|=I*128}),ne}var Ae;function ct(){return Ae||(Ae=1,(function(o){const r=ot(),a=ht(),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;o.Buffer=s,o.SlowBuffer=B,o.INSPECT_MAX_BYTES=50;const f=2147483647;o.kMaxLength=f,s.TYPED_ARRAY_SUPPORT=p(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{const i=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(i,e),i.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function d(i){if(i>f)throw new RangeError('The value "'+i+'" is invalid for option "size"');const e=new Uint8Array(i);return Object.setPrototypeOf(e,s.prototype),e}function s(i,e,t){if(typeof i=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(i)}return w(i,e,t)}s.poolSize=8192;function w(i,e,t){if(typeof i=="string")return y(i,e);if(ArrayBuffer.isView(i))return _(i);if(i==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(L(i,ArrayBuffer)||i&&L(i.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(L(i,SharedArrayBuffer)||i&&L(i.buffer,SharedArrayBuffer)))return I(i,e,t);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const n=i.valueOf&&i.valueOf();if(n!=null&&n!==i)return s.from(n,e,t);const h=m(i);if(h)return h;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return s.from(i[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}s.from=function(i,e,t){return w(i,e,t)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function b(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(i<0)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function E(i,e,t){return b(i),i<=0?d(i):e!==void 0?typeof t=="string"?d(i).fill(e,t):d(i).fill(e):d(i)}s.alloc=function(i,e,t){return E(i,e,t)};function x(i){return b(i),d(i<0?0:R(i)|0)}s.allocUnsafe=function(i){return x(i)},s.allocUnsafeSlow=function(i){return x(i)};function y(i,e){if((typeof e!="string"||e==="")&&(e="utf8"),!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=j(i,e)|0;let n=d(t);const h=n.write(i,e);return h!==t&&(n=n.slice(0,h)),n}function g(i){const e=i.length<0?0:R(i.length)|0,t=d(e);for(let n=0;n<e;n+=1)t[n]=i[n]&255;return t}function _(i){if(L(i,Uint8Array)){const e=new Uint8Array(i);return I(e.buffer,e.byteOffset,e.byteLength)}return g(i)}function I(i,e,t){if(e<0||i.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(i):t===void 0?n=new Uint8Array(i,e):n=new Uint8Array(i,e,t),Object.setPrototypeOf(n,s.prototype),n}function m(i){if(s.isBuffer(i)){const e=R(i.length)|0,t=d(e);return t.length===0||i.copy(t,0,0,e),t}if(i.length!==void 0)return typeof i.length!="number"||ge(i.length)?d(0):g(i);if(i.type==="Buffer"&&Array.isArray(i.data))return g(i.data)}function R(i){if(i>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return i|0}function B(i){return+i!=i&&(i=0),s.alloc(+i)}s.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==s.prototype},s.compare=function(e,t){if(L(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,h=t.length;for(let c=0,l=Math.min(n,h);c<l;++c)if(e[c]!==t[c]){n=e[c],h=t[c];break}return n<h?-1:h<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return s.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const h=s.allocUnsafe(t);let c=0;for(n=0;n<e.length;++n){let l=e[n];if(L(l,Uint8Array))c+l.length>h.length?(s.isBuffer(l)||(l=s.from(l)),l.copy(h,c)):Uint8Array.prototype.set.call(h,l,c);else if(s.isBuffer(l))l.copy(h,c);else throw new TypeError('"list" argument must be an Array of Buffers');c+=l.length}return h};function j(i,e){if(s.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||L(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);const t=i.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let h=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return xe(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return We(i).length;default:if(h)return n?-1:xe(i).length;e=(""+e).toLowerCase(),h=!0}}s.byteLength=j;function D(i,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(i||(i="utf8");;)switch(i){case"hex":return Lt(this,e,t);case"utf8":case"utf-8":return $e(this,e,t);case"ascii":return Ut(this,e,t);case"latin1":case"binary":return kt(this,e,t);case"base64":return jt(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mt(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),n=!0}}s.prototype._isBuffer=!0;function S(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}s.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)S(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?$e(this,0,e):D.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:s.compare(this,e)===0},s.prototype.inspect=function(){let e="";const t=o.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},u&&(s.prototype[u]=s.prototype.inspect),s.prototype.compare=function(e,t,n,h,c){if(L(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),h===void 0&&(h=0),c===void 0&&(c=this.length),t<0||n>e.length||h<0||c>this.length)throw new RangeError("out of range index");if(h>=c&&t>=n)return 0;if(h>=c)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,h>>>=0,c>>>=0,this===e)return 0;let l=c-h,F=n-t;const T=Math.min(l,F),N=this.slice(h,c),P=e.slice(t,n);for(let A=0;A<T;++A)if(N[A]!==P[A]){l=N[A],F=P[A];break}return l<F?-1:F<l?1:0};function oe(i,e,t,n,h){if(i.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,ge(t)&&(t=h?0:i.length-1),t<0&&(t=i.length+t),t>=i.length){if(h)return-1;t=i.length-1}else if(t<0)if(h)t=0;else return-1;if(typeof e=="string"&&(e=s.from(e,n)),s.isBuffer(e))return e.length===0?-1:z(i,e,t,n,h);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?h?Uint8Array.prototype.indexOf.call(i,e,t):Uint8Array.prototype.lastIndexOf.call(i,e,t):z(i,[e],t,n,h);throw new TypeError("val must be string, number or Buffer")}function z(i,e,t,n,h){let c=1,l=i.length,F=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(i.length<2||e.length<2)return-1;c=2,l/=2,F/=2,t/=2}function T(P,A){return c===1?P[A]:P.readUInt16BE(A*c)}let N;if(h){let P=-1;for(N=t;N<l;N++)if(T(i,N)===T(e,P===-1?0:N-P)){if(P===-1&&(P=N),N-P+1===F)return P*c}else P!==-1&&(N-=N-P),P=-1}else for(t+F>l&&(t=l-F),N=t;N>=0;N--){let P=!0;for(let A=0;A<F;A++)if(T(i,N+A)!==T(e,A)){P=!1;break}if(P)return N}return-1}s.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},s.prototype.indexOf=function(e,t,n){return oe(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return oe(this,e,t,n,!1)};function At(i,e,t,n){t=Number(t)||0;const h=i.length-t;n?(n=Number(n),n>h&&(n=h)):n=h;const c=e.length;n>c/2&&(n=c/2);let l;for(l=0;l<n;++l){const F=parseInt(e.substr(l*2,2),16);if(ge(F))return l;i[t+l]=F}return l}function Nt(i,e,t,n){return he(xe(e,i.length-t),i,t,n)}function St(i,e,t,n){return he(vt(e),i,t,n)}function Tt(i,e,t,n){return he(We(e),i,t,n)}function Pt(i,e,t,n){return he(Gt(e,i.length-t),i,t,n)}s.prototype.write=function(e,t,n,h){if(t===void 0)h="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")h=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,h===void 0&&(h="utf8")):(h=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const c=this.length-t;if((n===void 0||n>c)&&(n=c),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");h||(h="utf8");let l=!1;for(;;)switch(h){case"hex":return At(this,e,t,n);case"utf8":case"utf-8":return Nt(this,e,t,n);case"ascii":case"latin1":case"binary":return St(this,e,t,n);case"base64":return Tt(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pt(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),l=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function jt(i,e,t){return e===0&&t===i.length?r.fromByteArray(i):r.fromByteArray(i.slice(e,t))}function $e(i,e,t){t=Math.min(i.length,t);const n=[];let h=e;for(;h<t;){const c=i[h];let l=null,F=c>239?4:c>223?3:c>191?2:1;if(h+F<=t){let T,N,P,A;switch(F){case 1:c<128&&(l=c);break;case 2:T=i[h+1],(T&192)===128&&(A=(c&31)<<6|T&63,A>127&&(l=A));break;case 3:T=i[h+1],N=i[h+2],(T&192)===128&&(N&192)===128&&(A=(c&15)<<12|(T&63)<<6|N&63,A>2047&&(A<55296||A>57343)&&(l=A));break;case 4:T=i[h+1],N=i[h+2],P=i[h+3],(T&192)===128&&(N&192)===128&&(P&192)===128&&(A=(c&15)<<18|(T&63)<<12|(N&63)<<6|P&63,A>65535&&A<1114112&&(l=A))}}l===null?(l=65533,F=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|l&1023),n.push(l),h+=F}return Ct(n)}const Oe=4096;function Ct(i){const e=i.length;if(e<=Oe)return String.fromCharCode.apply(String,i);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,i.slice(n,n+=Oe));return t}function Ut(i,e,t){let n="";t=Math.min(i.length,t);for(let h=e;h<t;++h)n+=String.fromCharCode(i[h]&127);return n}function kt(i,e,t){let n="";t=Math.min(i.length,t);for(let h=e;h<t;++h)n+=String.fromCharCode(i[h]);return n}function Lt(i,e,t){const n=i.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let h="";for(let c=e;c<t;++c)h+=zt[i[c]];return h}function Mt(i,e,t){const n=i.slice(e,t);let h="";for(let c=0;c<n.length-1;c+=2)h+=String.fromCharCode(n[c]+n[c+1]*256);return h}s.prototype.slice=function(e,t){const n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);const h=this.subarray(e,t);return Object.setPrototypeOf(h,s.prototype),h};function C(i,e,t){if(i%1!==0||i<0)throw new RangeError("offset is not uint");if(i+e>t)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||C(e,t,this.length);let h=this[e],c=1,l=0;for(;++l<t&&(c*=256);)h+=this[e+l]*c;return h},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||C(e,t,this.length);let h=this[e+--t],c=1;for(;t>0&&(c*=256);)h+=this[e+--t]*c;return h},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e=e>>>0,t||C(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||C(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||C(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||C(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=$(function(e){e=e>>>0,H(e,"offset");const t=this[e],n=this[e+7];(t===void 0||n===void 0)&&Y(e,this.length-8);const h=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,c=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(h)+(BigInt(c)<<BigInt(32))}),s.prototype.readBigUInt64BE=$(function(e){e=e>>>0,H(e,"offset");const t=this[e],n=this[e+7];(t===void 0||n===void 0)&&Y(e,this.length-8);const h=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],c=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(h)<<BigInt(32))+BigInt(c)}),s.prototype.readIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||C(e,t,this.length);let h=this[e],c=1,l=0;for(;++l<t&&(c*=256);)h+=this[e+l]*c;return c*=128,h>=c&&(h-=Math.pow(2,8*t)),h},s.prototype.readIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||C(e,t,this.length);let h=t,c=1,l=this[e+--h];for(;h>0&&(c*=256);)l+=this[e+--h]*c;return c*=128,l>=c&&(l-=Math.pow(2,8*t)),l},s.prototype.readInt8=function(e,t){return e=e>>>0,t||C(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},s.prototype.readInt16LE=function(e,t){e=e>>>0,t||C(e,2,this.length);const n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n},s.prototype.readInt16BE=function(e,t){e=e>>>0,t||C(e,2,this.length);const n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n},s.prototype.readInt32LE=function(e,t){return e=e>>>0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e=e>>>0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=$(function(e){e=e>>>0,H(e,"offset");const t=this[e],n=this[e+7];(t===void 0||n===void 0)&&Y(e,this.length-8);const h=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(h)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),s.prototype.readBigInt64BE=$(function(e){e=e>>>0,H(e,"offset");const t=this[e],n=this[e+7];(t===void 0||n===void 0)&&Y(e,this.length-8);const h=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(h)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)}),s.prototype.readFloatLE=function(e,t){return e=e>>>0,t||C(e,4,this.length),a.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e=e>>>0,t||C(e,4,this.length),a.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||C(e,8,this.length),a.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||C(e,8,this.length),a.read(this,e,!1,52,8)};function U(i,e,t,n,h,c){if(!s.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>h||e<c)throw new RangeError('"value" argument is out of bounds');if(t+n>i.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,h){if(e=+e,t=t>>>0,n=n>>>0,!h){const F=Math.pow(2,8*n)-1;U(this,e,t,n,F,0)}let c=1,l=0;for(this[t]=e&255;++l<n&&(c*=256);)this[t+l]=e/c&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,h){if(e=+e,t=t>>>0,n=n>>>0,!h){const F=Math.pow(2,8*n)-1;U(this,e,t,n,F,0)}let c=n-1,l=1;for(this[t+c]=e&255;--c>=0&&(l*=256);)this[t+c]=e/l&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,1,255,0),this[t]=e&255,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function ve(i,e,t,n,h){Ve(e,n,h,i,t,7);let c=Number(e&BigInt(4294967295));i[t++]=c,c=c>>8,i[t++]=c,c=c>>8,i[t++]=c,c=c>>8,i[t++]=c;let l=Number(e>>BigInt(32)&BigInt(4294967295));return i[t++]=l,l=l>>8,i[t++]=l,l=l>>8,i[t++]=l,l=l>>8,i[t++]=l,t}function Ge(i,e,t,n,h){Ve(e,n,h,i,t,7);let c=Number(e&BigInt(4294967295));i[t+7]=c,c=c>>8,i[t+6]=c,c=c>>8,i[t+5]=c,c=c>>8,i[t+4]=c;let l=Number(e>>BigInt(32)&BigInt(4294967295));return i[t+3]=l,l=l>>8,i[t+2]=l,l=l>>8,i[t+1]=l,l=l>>8,i[t]=l,t+8}s.prototype.writeBigUInt64LE=$(function(e,t=0){return ve(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=$(function(e,t=0){return Ge(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,n,h){if(e=+e,t=t>>>0,!h){const T=Math.pow(2,8*n-1);U(this,e,t,n,T-1,-T)}let c=0,l=1,F=0;for(this[t]=e&255;++c<n&&(l*=256);)e<0&&F===0&&this[t+c-1]!==0&&(F=1),this[t+c]=(e/l>>0)-F&255;return t+n},s.prototype.writeIntBE=function(e,t,n,h){if(e=+e,t=t>>>0,!h){const T=Math.pow(2,8*n-1);U(this,e,t,n,T-1,-T)}let c=n-1,l=1,F=0;for(this[t+c]=e&255;--c>=0&&(l*=256);)e<0&&F===0&&this[t+c+1]!==0&&(F=1),this[t+c]=(e/l>>0)-F&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},s.prototype.writeBigInt64LE=$(function(e,t=0){return ve(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=$(function(e,t=0){return Ge(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ze(i,e,t,n,h,c){if(t+n>i.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function qe(i,e,t,n,h){return e=+e,t=t>>>0,h||ze(i,e,t,4),a.write(i,e,t,n,23,4),t+4}s.prototype.writeFloatLE=function(e,t,n){return qe(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return qe(this,e,t,!1,n)};function He(i,e,t,n,h){return e=+e,t=t>>>0,h||ze(i,e,t,8),a.write(i,e,t,n,52,8),t+8}s.prototype.writeDoubleLE=function(e,t,n){return He(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return He(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,h){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!h&&h!==0&&(h=this.length),t>=e.length&&(t=e.length),t||(t=0),h>0&&h<n&&(h=n),h===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),e.length-t<h-n&&(h=e.length-t+n);const c=h-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,h):Uint8Array.prototype.set.call(e,this.subarray(n,h),t),c},s.prototype.fill=function(e,t,n,h){if(typeof e=="string"){if(typeof t=="string"?(h=t,t=0,n=this.length):typeof n=="string"&&(h=n,n=this.length),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!s.isEncoding(h))throw new TypeError("Unknown encoding: "+h);if(e.length===1){const l=e.charCodeAt(0);(h==="utf8"&&l<128||h==="latin1")&&(e=l)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let c;if(typeof e=="number")for(c=t;c<n;++c)this[c]=e;else{const l=s.isBuffer(e)?e:s.from(e,h),F=l.length;if(F===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(c=0;c<n-t;++c)this[c+t]=l[c%F]}return this};const q={};function _e(i,e,t){q[i]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${i}]`,this.stack,delete this.name}get code(){return i}set code(h){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:h,writable:!0})}toString(){return`${this.name} [${i}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(i){return i?`${i} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_e("ERR_INVALID_ARG_TYPE",function(i,e){return`The "${i}" argument must be of type number. Received type ${typeof e}`},TypeError),_e("ERR_OUT_OF_RANGE",function(i,e,t){let n=`The value of "${i}" is out of range.`,h=t;return Number.isInteger(t)&&Math.abs(t)>2**32?h=Qe(String(t)):typeof t=="bigint"&&(h=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(h=Qe(h)),h+="n"),n+=` It must be ${e}. Received ${h}`,n},RangeError);function Qe(i){let e="",t=i.length;const n=i[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${i.slice(t-3,t)}${e}`;return`${i.slice(0,t)}${e}`}function Dt(i,e,t){H(e,"offset"),(i[e]===void 0||i[e+t]===void 0)&&Y(e,i.length-(t+1))}function Ve(i,e,t,n,h,c){if(i>t||i<e){const l=typeof e=="bigint"?"n":"";let F;throw e===0||e===BigInt(0)?F=`>= 0${l} and < 2${l} ** ${(c+1)*8}${l}`:F=`>= -(2${l} ** ${(c+1)*8-1}${l}) and < 2 ** ${(c+1)*8-1}${l}`,new q.ERR_OUT_OF_RANGE("value",F,i)}Dt(n,h,c)}function H(i,e){if(typeof i!="number")throw new q.ERR_INVALID_ARG_TYPE(e,"number",i)}function Y(i,e,t){throw Math.floor(i)!==i?(H(i,t),new q.ERR_OUT_OF_RANGE("offset","an integer",i)):e<0?new q.ERR_BUFFER_OUT_OF_BOUNDS:new q.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,i)}const $t=/[^+/0-9A-Za-z-_]/g;function Ot(i){if(i=i.split("=")[0],i=i.trim().replace($t,""),i.length<2)return"";for(;i.length%4!==0;)i=i+"=";return i}function xe(i,e){e=e||1/0;let t;const n=i.length;let h=null;const c=[];for(let l=0;l<n;++l){if(t=i.charCodeAt(l),t>55295&&t<57344){if(!h){if(t>56319){(e-=3)>-1&&c.push(239,191,189);continue}else if(l+1===n){(e-=3)>-1&&c.push(239,191,189);continue}h=t;continue}if(t<56320){(e-=3)>-1&&c.push(239,191,189),h=t;continue}t=(h-55296<<10|t-56320)+65536}else h&&(e-=3)>-1&&c.push(239,191,189);if(h=null,t<128){if((e-=1)<0)break;c.push(t)}else if(t<2048){if((e-=2)<0)break;c.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;c.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;c.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return c}function vt(i){const e=[];for(let t=0;t<i.length;++t)e.push(i.charCodeAt(t)&255);return e}function Gt(i,e){let t,n,h;const c=[];for(let l=0;l<i.length&&!((e-=2)<0);++l)t=i.charCodeAt(l),n=t>>8,h=t%256,c.push(h),c.push(n);return c}function We(i){return r.toByteArray(Ot(i))}function he(i,e,t,n){let h;for(h=0;h<n&&!(h+t>=e.length||h>=i.length);++h)e[h+t]=i[h];return h}function L(i,e){return i instanceof e||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===e.name}function ge(i){return i!==i}const zt=(function(){const i="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const n=t*16;for(let h=0;h<16;++h)e[n+h]=i[t]+i[h]}return e})();function $(i){return typeof BigInt>"u"?qt:i}function qt(){throw new Error("BigInt not supported")}})(de)),de}var ft=ct();const V="http://www.w3.org/1999/02/22-rdf-syntax-ns#",W="http://www.w3.org/2001/XMLSchema#",se="http://www.w3.org/2000/10/swap/";var k={xsd:{decimal:`${W}decimal`,boolean:`${W}boolean`,double:`${W}double`,integer:`${W}integer`,string:`${W}string`},rdf:{type:`${V}type`,nil:`${V}nil`,first:`${V}first`,rest:`${V}rest`,langString:`${V}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${se}reify#forSome`,forAll:`${se}reify#forAll`},log:{implies:`${se}log#implies`,isImpliedBy:`${se}log#isImpliedBy`}};const{xsd:ae}=k,lt=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,Ne={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},dt=/[\x00-\x20<>\\"\{\}\|\^\`]/,pt={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},_t=/$0^/;class xt{constructor(r){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,r=r||{},this._isImpliedBy=r.isImpliedBy,this._lineMode=!!r.lineMode){this._n3Mode=!1;for(const a in this)!(a in pt)&&this[a]instanceof RegExp&&(this[a]=_t)}else this._n3Mode=r.n3!==!1;this.comments=!!r.comments,this._literalClosingPos=0}_tokenizeToEnd(r,a){let u=this._input,f=u.length;for(;;){let s,w;for(;s=this._newline.exec(u);)this.comments&&(w=this._comment.exec(s[0]))&&p("comment",w[1],"",this._line,s[0].length),u=u.substr(s[0].length,u.length),f=u.length,this._line++;if(!s&&(s=this._whitespace.exec(u))&&(u=u.substr(s[0].length,u.length)),this._endOfFile.test(u))return a&&(this.comments&&(w=this._comment.exec(u))&&p("comment",w[1],"",this._line,u.length),u=null,p("eof","","",this._line,0)),this._input=u;const b=this._line,E=u[0];let x="",y="",g="",_=null,I=0,m=!1;switch(E){case"^":if(u.length<3)break;if(u[1]==="^"){if(this._previousMarker="^^",u=u.substr(2),u[0]!=="<"){m=!0;break}}else{this._n3Mode&&(I=1,x="^");break}case"<":if(_=this._unescapedIri.exec(u))x="IRI",y=_[1];else if(_=this._iri.exec(u)){if(y=this._unescape(_[1]),y===null||dt.test(y))return d(this);x="IRI"}else u.length>1&&u[1]==="<"?(x="<<",I=2):this._n3Mode&&u.length>1&&u[1]==="="&&(I=2,this._isImpliedBy?(x="abbreviation",y="<"):(x="inverse",y=">"));break;case">":u.length>1&&u[1]===">"&&(x=">>",I=2);break;case"_":((_=this._blank.exec(u))||a&&(_=this._blank.exec(`${u} `)))&&(x="blank",g="_",y=_[1]);break;case'"':if(_=this._simpleQuotedString.exec(u))y=_[1];else if({value:y,matchLength:I}=this._parseLiteral(u),y===null)return d(this);(_!==null||I!==0)&&(x="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(_=this._simpleApostropheString.exec(u))y=_[1];else if({value:y,matchLength:I}=this._parseLiteral(u),y===null)return d(this);(_!==null||I!==0)&&(x="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(_=this._variable.exec(u))&&(x="var",y=_[0]);break;case"@":this._previousMarker==="literal"&&(_=this._langcode.exec(u))?(x="langcode",y=_[1]):(_=this._keyword.exec(u))&&(x=_[0]);break;case".":if(u.length===1?a:u[1]<"0"||u[1]>"9"){x=".",I=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(_=this._number.exec(u)||a&&(_=this._number.exec(`${u} `)))&&(x="literal",y=_[0],g=typeof _[1]=="string"?ae.double:typeof _[2]=="string"?ae.decimal:ae.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(_=this._sparqlKeyword.exec(u))?x=_[0].toUpperCase():m=!0;break;case"f":case"t":(_=this._boolean.exec(u))?(x="literal",y=_[0],g=ae.boolean):m=!0;break;case"a":(_=this._shortPredicates.exec(u))?(x="abbreviation",y="a"):m=!0;break;case"=":this._n3Mode&&u.length>1&&(x="abbreviation",u[1]!==">"?(I=1,y="="):(I=2,y=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(I=1,x=E);break;case"{":!this._lineMode&&u.length>=2&&(u[1]==="|"?(x="{|",I=2):(x=E,I=1));break;case"|":u.length>=2&&u[1]==="}"&&(x="|}",I=2);break;default:m=!0}if(m&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(_=this._prefix.exec(u))?(x="prefix",y=_[1]||""):((_=this._prefixed.exec(u))||a&&(_=this._prefixed.exec(`${u} `)))&&(x="prefixed",g=_[1]||"",y=this._unescape(_[2]))),this._previousMarker==="^^")switch(x){case"prefixed":x="type";break;case"IRI":x="typeIRI";break;default:x=""}if(!x)return a||!/^'''|^"""/.test(u)&&/\n|\r/.test(u)?d(this):this._input=u;const R=I||_[0].length,B=p(x,y,g,b,R);this.previousToken=B,this._previousMarker=x,u=u.substr(R,u.length)}function p(s,w,b,E,x){const y=u?f-u.length:f,g=y+x,_={type:s,value:w,prefix:b,line:E,start:y,end:g};return r(null,_),_}function d(s){r(s._syntaxError(/^\S*/.exec(u)[0]))}}_unescape(r){let a=!1;const u=r.replace(lt,(f,p,d,s)=>{if(typeof p=="string")return String.fromCharCode(Number.parseInt(p,16));if(typeof d=="string"){let w=Number.parseInt(d,16);return w<=65535?String.fromCharCode(Number.parseInt(d,16)):String.fromCharCode(55296+((w-=65536)>>10),56320+(w&1023))}return s in Ne?Ne[s]:(a=!0,"")});return a?null:u}_parseLiteral(r){if(r.length>=3){const a=r.match(/^(?:"""|"|'''|'|)/)[0],u=a.length;let f=Math.max(this._literalClosingPos,u);for(;(f=r.indexOf(a,f))>0;){let p=0;for(;r[f-p-1]==="\\";)p++;if(p%2===0){const d=r.substring(u,f),s=d.split(/\r\n|\r|\n/).length-1,w=f+u;if(u===1&&s!==0||u===3&&this._lineMode)break;return this._line+=s,{value:this._unescape(d),matchLength:w}}f++}this._literalClosingPos=r.length-u+1}return{value:"",matchLength:0}}_syntaxError(r){this._input=null;const a=new Error(`Unexpected "${r}" on line ${this._line}.`);return a.context={token:void 0,line:this._line,previousToken:this.previousToken},a}_readStartingBom(r){return r.startsWith("\uFEFF")?r.substr(1):r}tokenize(r,a){if(this._line=1,typeof r=="string")if(this._input=this._readStartingBom(r),typeof a=="function")queueMicrotask(()=>this._tokenizeToEnd(a,!0));else{const u=[];let f;if(this._tokenizeToEnd((p,d)=>p?f=p:u.push(d),!0),f)throw f;return u}else this._pendingBuffer=null,typeof r.setEncoding=="function"&&r.setEncoding("utf8"),r.on("data",u=>{this._input!==null&&u.length!==0&&(this._pendingBuffer&&(u=ft.Buffer.concat([this._pendingBuffer,u]),this._pendingBuffer=null),u[u.length-1]&128?this._pendingBuffer=u:(typeof this._input>"u"?this._input=this._readStartingBom(typeof u=="string"?u:u.toString()):this._input+=u,this._tokenizeToEnd(a,!1)))}),r.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(a,!0)}),r.on("error",a)}}const{rdf:gt,xsd:G}=k;let J,yt=0;const wt={namedNode:Pe,blankNode:je,variable:Ue,literal:Ce,defaultGraph:It,quad:pe,triple:pe,fromTerm:X,fromQuad:ke};class M{constructor(r){this.id=r}get value(){return this.id}equals(r){return r instanceof M?this.id===r.id:!!r&&this.termType===r.termType&&this.value===r.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class Se extends M{get termType(){return"NamedNode"}}class Z extends M{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const r=this.id;let a=r.lastIndexOf('"')+1;return a<r.length&&r[a++]==="@"?r.substr(a).toLowerCase():""}get datatype(){return new Se(this.datatypeString)}get datatypeString(){const r=this.id,a=r.lastIndexOf('"')+1,u=a<r.length?r[a]:"";return u==="^"?r.substr(a+2):u!=="@"?G.string:gt.langString}equals(r){return r instanceof Z?this.id===r.id:!!r&&!!r.datatype&&this.termType===r.termType&&this.value===r.value&&this.language===r.language&&this.datatype.value===r.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class mt extends M{constructor(r){super(`_:${r}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class bt extends M{constructor(r){super(`?${r}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class Et extends M{constructor(){return super(""),J||this}get termType(){return"DefaultGraph"}equals(r){return this===r||!!r&&this.termType===r.termType}}J=new Et;class Te extends M{constructor(r,a,u,f){super(""),this._subject=r,this._predicate=a,this._object=u,this._graph=f||J}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(r){return!!r&&this._subject.equals(r.subject)&&this._predicate.equals(r.predicate)&&this._object.equals(r.object)&&this._graph.equals(r.graph)}}function Pe(o){return new Se(o)}function je(o){return new mt(o||`n3-${yt++}`)}function Ce(o,r){if(typeof r=="string")return new Z(`"${o}"@${r.toLowerCase()}`);let a=r?r.value:"";return a===""&&(typeof o=="boolean"?a=G.boolean:typeof o=="number"&&(Number.isFinite(o)?a=Number.isInteger(o)?G.integer:G.double:(a=G.double,Number.isNaN(o)||(o=o>0?"INF":"-INF")))),a===""||a===G.string?new Z(`"${o}"`):new Z(`"${o}"^^${a}`)}function Ue(o){return new bt(o)}function It(){return J}function pe(o,r,a,u){return new Te(o,r,a,u)}function X(o){if(o instanceof M)return o;switch(o.termType){case"NamedNode":return Pe(o.value);case"BlankNode":return je(o.value);case"Variable":return Ue(o.value);case"DefaultGraph":return J;case"Literal":return Ce(o.value,o.language||o.datatype);case"Quad":return ke(o);default:throw new Error(`Unexpected termType: ${o.termType}`)}}function ke(o){if(o instanceof Te)return o;if(o.termType!=="Quad")throw new Error(`Unexpected termType: ${o.termType}`);return pe(X(o.subject),X(o.predicate),X(o.object),X(o.graph))}let Le=0;class Me{constructor(r){this._contextStack=[],this._graph=null,r=r||{},this._setBase(r.baseIRI),r.factory&&De(this,r.factory);const a=typeof r.format=="string"?r.format.match(/\w*$/)[0].toLowerCase():"",u=/turtle/.test(a),f=/trig/.test(a),p=/triple/.test(a),d=/quad/.test(a),s=this._n3Mode=/n3/.test(a),w=p||d;(this._supportsNamedGraphs=!(u||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(u||f||p||s),this._isImpliedBy=r.isImpliedBy,this._supportsRDFStar=a===""||/star|\*$/.test(a),w&&(this._resolveRelativeIRI=b=>null),this._blankNodePrefix=typeof r.blankNodePrefix!="string"?"":r.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=r.lexer||new xt({lineMode:w,n3:s,isImpliedBy:this._isImpliedBy}),this._explicitQuantifiers=!!r.explicitQuantifiers}static _resetBlankNodePrefix(){Le=0}_setBase(r){if(!r)this._base="",this._basePath="";else{const a=r.indexOf("#");a>=0&&(r=r.substr(0,a)),this._base=r,this._basePath=r.indexOf("/")<0?r:r.replace(/[^\/?]*(?:\?.*)?$/,""),r=r.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=r[0],this._baseScheme=r[1]}}_saveContext(r,a,u,f,p){const d=this._n3Mode;this._contextStack.push({type:r,subject:u,predicate:f,object:p,graph:a,inverse:d?this._inversePredicate:!1,blankPrefix:d?this._prefixes._:"",quantified:d?this._quantified:null}),d&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(r,a){const u=this._contextStack.pop();if(!u||u.type!==r)return this._error(`Unexpected ${a.type}`,a);this._subject=u.subject,this._predicate=u.predicate,this._object=u.object,this._graph=u.graph,this._n3Mode&&(this._inversePredicate=u.inverse,this._prefixes._=u.blankPrefix,this._quantified=u.quantified)}_readInTopContext(r){switch(r.type){case"eof":return this._graph!==null?this._error("Unclosed graph",r):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(r)}}_readEntity(r,a){let u;switch(r.type){case"IRI":case"typeIRI":const f=this._resolveIRI(r.value);if(f===null)return this._error("Invalid IRI",r);u=this._factory.namedNode(f);break;case"type":case"prefixed":const p=this._prefixes[r.prefix];if(p===void 0)return this._error(`Undefined prefix "${r.prefix}:"`,r);u=this._factory.namedNode(p+r.value);break;case"blank":u=this._factory.blankNode(this._prefixes[r.prefix]+r.value);break;case"var":u=this._factory.variable(r.value.substr(1));break;default:return this._error(`Expected entity but got ${r.type}`,r)}return!a&&this._n3Mode&&u.id in this._quantified&&(u=this._quantified[u.id]),u}_readSubject(r){switch(this._predicate=null,r.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._factory.blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._factory.blankNode(),null,null),this._readSubject):this._error("Unexpected graph",r);case"}":return this._readPunctuation(r);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier="blankNode",this._readQuantifierList):this._error('Unexpected "@forSome"',r);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier="variable",this._readQuantifierList):this._error('Unexpected "@forAll"',r);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",r);if(r.prefix.length===0)return this._literalValue=r.value,this._completeSubjectLiteral;this._subject=this._factory.literal(r.value,this._factory.namedNode(r.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",r);default:if((this._subject=this._readEntity(r))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(r){const a=r.type;switch(a){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[r.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${a}`,r):(this._subject=null,a==="]"?this._readBlankNodeTail(r):this._readPunctuation(r));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",r);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._factory.blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",r);default:if((this._predicate=this._readEntity(r))===void 0)return}return this._readObject}_readObject(r){switch(r.type){case"literal":if(r.prefix.length===0)return this._literalValue=r.value,this._readDataTypeOrLang;this._object=this._factory.literal(r.value,this._factory.namedNode(r.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._factory.blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",r);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",r);default:if((this._object=this._readEntity(r))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(r){return r.type==="{"?this._readGraph(r):this._readPredicate(r)}_readGraph(r){return r.type!=="{"?this._error(`Expected graph but got ${r.type}`,r):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(r){return r.type==="]"?(this._subject=null,this._readBlankNodeTail(r)):(this._predicate=null,this._readPredicate(r))}_readBlankNodeTail(r){if(r.type!=="]")return this._readBlankNodePunctuation(r);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);const a=this._predicate===null;return this._restoreContext("blank",r),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:a?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(r){switch(r.type){case".":case"}":return this._subject=null,this._readPunctuation(r);default:return this._readPredicate(r)}}_readListItem(r){let a=null,u=null,f=this._readListItem;const p=this._subject,d=this._contextStack,s=d[d.length-1];switch(r.type){case"[":this._saveContext("blank",this._graph,u=this._factory.blankNode(),this.RDF_FIRST,this._subject=a=this._factory.blankNode()),f=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,u=this._factory.blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",r),d.length!==0&&d[d.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(f=this._readPredicate,this._subject===this.RDF_NIL)return f}else if(f=this._getContextEndReader(),this._object===this.RDF_NIL)return f;u=this.RDF_NIL;break;case"literal":r.prefix.length===0?(this._literalValue=r.value,f=this._readListItemDataTypeOrLang):(a=this._factory.literal(r.value,this._factory.namedNode(r.prefix)),f=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",r);default:if((a=this._readEntity(r))===void 0)return}if(u===null&&(this._subject=u=this._factory.blankNode()),p===null?s.predicate===null?s.subject=u:s.object=u:this._emit(p,this.RDF_REST,u,this._graph),a!==null){if(this._n3Mode&&(r.type==="IRI"||r.type==="prefixed"))return this._saveContext("item",this._graph,u,this.RDF_FIRST,a),this._subject=a,this._predicate=null,this._getPathReader(this._readListItem);this._emit(u,this.RDF_FIRST,a,this._graph)}return f}_readDataTypeOrLang(r){return this._completeObjectLiteral(r,!1)}_readListItemDataTypeOrLang(r){return this._completeObjectLiteral(r,!0)}_completeLiteral(r){let a=this._factory.literal(this._literalValue);switch(r.type){case"type":case"typeIRI":const u=this._readEntity(r);if(u===void 0)return;a=this._factory.literal(this._literalValue,u),r=null;break;case"langcode":a=this._factory.literal(this._literalValue,r.value),r=null;break}return{token:r,literal:a}}_completeSubjectLiteral(r){return this._subject=this._completeLiteral(r).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(r,a){const u=this._completeLiteral(r);if(u)return this._object=u.literal,a&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),u.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(u.token))}_readFormulaTail(r){return r.type!=="}"?this._readPunctuation(r):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",r),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(r){let a,u=this._graph;const f=this._subject,p=this._inversePredicate;switch(r.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",r);if(this._n3Mode)return this._readFormulaTail(r);this._graph=null;case".":this._subject=null,a=this._contextStack.length?this._readSubject:this._readInTopContext,p&&(this._inversePredicate=!1);break;case";":a=this._readPredicate;break;case",":a=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",r);const d=this._predicate,s=this._object;this._subject=this._factory.quad(f,d,s,this.DEFAULTGRAPH),a=this._readPredicate;break;case"|}":if(this._subject.termType!=="Quad")return this._error("Unexpected asserted triple closing",r);this._subject=null,a=this._readPunctuation;break;default:if(this._supportsQuads&&this._graph===null&&(u=this._readEntity(r))!==void 0){a=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,r)}if(f!==null){const d=this._predicate,s=this._object;p?this._emit(s,d,f,u):this._emit(f,d,s,u)}return a}_readBlankNodePunctuation(r){let a;switch(r.type){case";":a=this._readPredicate;break;case",":a=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,r)}return this._emit(this._subject,this._predicate,this._object,this._graph),a}_readQuadPunctuation(r){return r.type!=="."?this._error("Expected dot to follow quad",r):this._readInTopContext}_readPrefix(r){return r.type!=="prefix"?this._error("Expected prefix to follow @prefix",r):(this._prefix=r.value,this._readPrefixIRI)}_readPrefixIRI(r){if(r.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,r);const a=this._readEntity(r);return this._prefixes[this._prefix]=a.value,this._prefixCallback(this._prefix,a),this._readDeclarationPunctuation}_readBaseIRI(r){const a=r.type==="IRI"&&this._resolveIRI(r.value);return a?(this._setBase(a),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",r)}_readNamedGraphLabel(r){switch(r.type){case"IRI":case"blank":case"prefixed":return this._readSubject(r),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",r)}}_readNamedGraphBlankLabel(r){return r.type!=="]"?this._error("Invalid graph label",r):(this._subject=this._factory.blankNode(),this._readGraph)}_readDeclarationPunctuation(r){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(r)):r.type!=="."?this._error("Expected declaration to end with a dot",r):this._readInTopContext}_readQuantifierList(r){let a;switch(r.type){case"IRI":case"prefixed":if((a=this._readEntity(r,!0))!==void 0)break;default:return this._error(`Unexpected ${r.type}`,r)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,a,this.QUANTIFIERS_GRAPH)):this._quantified[a.id]=this._factory[this._quantifier](this._factory.blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(r){return r.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(r))}_getPathReader(r){return this._afterPath=r,this._readPath}_readPath(r){switch(r.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const a=this._contextStack,u=a.length&&a[a.length-1];if(u&&u.type==="item"){const f=this._subject;this._restoreContext("item",r),this._emit(this._subject,this.RDF_FIRST,f,this._graph)}return this._afterPath(r)}}_readForwardPath(r){let a,u;const f=this._factory.blankNode();if((u=this._readEntity(r))!==void 0)return this._predicate===null?(a=this._subject,this._subject=f):(a=this._object,this._object=f),this._emit(a,u,f,this._graph),this._readPath}_readBackwardPath(r){const a=this._factory.blankNode();let u,f;if((u=this._readEntity(r))!==void 0)return this._predicate===null?(f=this._subject,this._subject=a):(f=this._object,this._object=a),this._emit(a,u,f,this._graph),this._readPath}_readRDFStarTailOrGraph(r){return r.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(r))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,r):this._readRDFStarTail(r)}_readRDFStarTail(r){if(r.type!==">>")return this._error(`Expected >> but got ${r.type}`,r);const a=this._factory.quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",r),this._subject===null?(this._subject=a,this._readPredicate):(this._object=a,this._getContextEndReader())}_getContextEndReader(){const r=this._contextStack;if(!r.length)return this._readPunctuation;switch(r[r.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(r,a,u,f){this._callback(null,this._factory.quad(r,a,u,f||this.DEFAULTGRAPH))}_error(r,a){const u=new Error(`${r} on line ${a.line}.`);u.context={token:a,line:a.line,previousToken:this._lexer.previousToken},this._callback(u),this._callback=ue}_resolveIRI(r){return/^[a-z][a-z0-9+.-]*:/i.test(r)?r:this._resolveRelativeIRI(r)}_resolveRelativeIRI(r){if(!r.length)return this._base;switch(r[0]){case"#":return this._base+r;case"?":return this._base.replace(/(?:\?.*)?$/,r);case"/":return(r[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(r);default:return/^[^/:]*:/.test(r)?null:this._removeDotSegments(this._basePath+r)}}_removeDotSegments(r){if(!/(^|\/)\.\.?($|[/#?])/.test(r))return r;const a=r.length;let u="",f=-1,p=-1,d=0,s="/";for(;f<a;){switch(s){case":":if(p<0&&r[++f]==="/"&&r[++f]==="/")for(;(p=f+1)<a&&r[p]!=="/";)f=p;break;case"?":case"#":f=a;break;case"/":if(r[f+1]===".")switch(s=r[++f+1],s){case"/":u+=r.substring(d,f-1),d=f+1;break;case void 0:case"?":case"#":return u+r.substring(d,f)+r.substr(f+1);case".":if(s=r[++f+1],s===void 0||s==="/"||s==="?"||s==="#"){if(u+=r.substring(d,f-2),(d=u.lastIndexOf("/"))>=p&&(u=u.substr(0,d)),s!=="/")return`${u}/${r.substr(f+1)}`;d=f+1}}}s=r[++f]}return u+r.substring(d)}parse(r,a,u){let f,p,d;if(a&&(a.onQuad||a.onPrefix||a.onComment)?(f=a.onQuad,p=a.onPrefix,d=a.onComment):(f=a,p=u),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Le++}_`,this._prefixCallback=p||ue,this._inversePredicate=!1,this._quantified=Object.create(null),!f){const w=[];let b;if(this._callback=(E,x)=>{E?b=E:x&&w.push(x)},this._lexer.tokenize(r).every(E=>this._readCallback=this._readCallback(E)),b)throw b;return w}let s=(w,b)=>{w!==null?(this._callback(w),this._callback=ue):this._readCallback&&(this._readCallback=this._readCallback(b))};d&&(this._lexer.comments=!0,s=(w,b)=>{w!==null?(this._callback(w),this._callback=ue):this._readCallback&&(b.type==="comment"?d(b.value):this._readCallback=this._readCallback(b))}),this._callback=f,this._lexer.tokenize(r,s)}}function ue(){}function De(o,r){o._factory=r,o.DEFAULTGRAPH=r.defaultGraph(),o.RDF_FIRST=r.namedNode(k.rdf.first),o.RDF_REST=r.namedNode(k.rdf.rest),o.RDF_NIL=r.namedNode(k.rdf.nil),o.N3_FORALL=r.namedNode(k.r.forAll),o.N3_FORSOME=r.namedNode(k.r.forSome),o.ABBREVIATIONS={a:r.namedNode(k.rdf.type),"=":r.namedNode(k.owl.sameAs),">":r.namedNode(k.log.implies),"<":r.namedNode(k.log.isImpliedBy)},o.QUANTIFIERS_GRAPH=r.namedNode("urn:n3:quantifiers")}De(Me.prototype,wt);const Bt=async o=>new Promise((r,a)=>{const u=new Me,f=[];u.parse(o,(p,d)=>{if(p){a(p);return}if(d)f.push(d);else try{r(Rt(f))}catch(s){a(s)}})}),Ft=o=>{if(o)return o.toLowerCase().split("-")[0]},Rt=o=>{const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",a="http://www.w3.org/ns/shacl#ValidationReport",u="http://www.w3.org/ns/shacl#result",f="http://xmlns.com/foaf/0.1/page",p=o.find(m=>m.predicate.value===r&&m.object.value===a)?.subject;if(!p)throw new Error("No sh:ValidationReport found in the input.");const s=o.find(m=>m.subject.equals(p)&&m.predicate.value==="http://www.w3.org/ns/shacl#conforms")?.object.value==="true",w=o.filter(m=>m.subject.equals(p)&&m.predicate.value===u).map(m=>m.object),b=[],E=[],x=[],y=(m,R)=>o.find(B=>B.subject.equals(m)&&B.predicate.value===R)?.object,g=(m,R)=>o.filter(B=>B.subject.equals(m)&&B.predicate.value===R).map(B=>B.object),_=(m,R)=>y(m,R)?.value||"",I=(m,R)=>g(m,R).map(B=>B?.value?{text:B.value,lang:Ft(B.language)}:null).filter(B=>!!B?.text);for(const m of w){const R=_(m,"http://www.w3.org/ns/shacl#resultSeverity");let B="Violation";R?.endsWith("Warning")&&(B="Warning"),R?.endsWith("Info")&&(B="Info");const j=y(m,"http://www.w3.org/ns/shacl#sourceShape"),D=j?.value||"",S=j?_(j,f):"",oe=I(m,"http://www.w3.org/ns/shacl#resultMessage"),z={severity:B,focusNode:_(m,"http://www.w3.org/ns/shacl#focusNode"),path:_(m,"http://www.w3.org/ns/shacl#resultPath"),value:_(m,"http://www.w3.org/ns/shacl#value"),message:oe,sourceConstraintComponent:_(m,"http://www.w3.org/ns/shacl#sourceConstraintComponent"),sourceShape:D,foafPage:S||void 0};B==="Violation"?b.push(z):B==="Warning"?E.push(z):x.push(z)}return{conforms:s,violations:b,warnings:E,infos:x,totalViolations:b.length,profile:"imported-report",timestamp:new Date().toISOString()}};fe({parseShaclReport:Bt,flattenReport:o=>{const r=[],a=(f,p)=>{r.push({...f,id:`${f.severity}-${p}-${f.focusNode}`,constraintKey:`${f.sourceShape}-${f.sourceConstraintComponent}`})};o.violations.forEach(a),o.warnings.forEach((f,p)=>a(f,o.violations.length+p)),o.infos.forEach((f,p)=>a(f,o.violations.length+o.warnings.length+p));const u={violation:o.violations.length,warning:o.warnings.length,info:o.infos.length,total:r.length};return{rows:r,summary:u}}})})();

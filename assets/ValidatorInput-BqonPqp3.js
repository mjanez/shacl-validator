const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-DDTMawMR.js","assets/charts-BadQMOzK.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-D3Wn7UNJ.js";import{r as a,W as Je}from"./charts-BadQMOzK.js";import{u as ke,T as We}from"./textarea-aiGtNTGE.js";import{c as L,u as Y,a as K,T as X,b as A,d as $,B as k,e as H,D as se,f as re,g as te,h as ae,i as Se,_ as qe,j as Ge,R as B}from"./index-C_N_pDr6.js";import{C as ue,a as me,b as xe,c as pe,d as he,e as Qe}from"./card-D9Z4SY08.js";import{B as ne}from"./badge-Dz63Ssq7.js";import{I as oe,d as le,e as ie,T as de,f as _,g as ce,h as Xe,i as be,j as G,k as Ye,c as Ze,l as Ke,m as es,n as ss,E as rs,o as Ne,X as ts}from"./icons-oLbWWKZ2.js";import{I as Te}from"./input-DBSPPz-I.js";import{T as De,a as Ee,b as O,c as J}from"./tabs-BWv615uy.js";import"./ui-kIuPQhpd.js";import"./rdf-DktVfMyT.js";const Q=a.forwardRef(({className:c,...p},s)=>e.jsx("label",{ref:s,className:L("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",c),...p}));Q.displayName="Label";const as=({selectedProfile:c,onProfileChange:p,disabled:s=!1})=>{const{t:n}=Y(),C=K.profiles,h=(l,u)=>{const w=C[l]?.versions?.[u];return w?n(`profiles.names.${l}.${u}`,{defaultValue:w.name}):l},y=(l,u)=>n(`profiles.branches.${l}`,{defaultValue:u||l}),j=l=>{const u=C[l].defaultVersion,v=C[l].defaultBranch||"main";p({profile:l,version:u,branch:v,mode:"predefined"})},S=l=>{p({...c,version:l})},U=l=>{p({...c,branch:l})},N=C[c.profile],T=N?.versions[c.version],z=N?Object.keys(N.versions).sort().reverse():[],g=N?.branches||{},E=Object.keys(g).length>0,b=c.branch||N?.defaultBranch||"main",I=(l,u)=>e.jsxs(k,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:s,children:[e.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[u&&e.jsx("img",{src:u,alt:"",className:"h-6 w-6"}),l]}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]}),P=(l,u)=>e.jsxs(k,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:s||u,children:[e.jsx("span",{className:"text-sm font-medium",children:l}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]});return e.jsxs(ue,{className:"border border-border/70 bg-card",children:[e.jsxs(me,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(xe,{className:"text-base",children:n("validator.selectProfile")}),e.jsx(pe,{children:n("validator.workspaceSubtitle")})]}),T&&e.jsx(X,{children:e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",asChild:!0,"aria-label":n("validator.profileInfo")??"Profile documentation",children:e.jsx("a",{href:T.url,target:"_blank",rel:"noreferrer",className:"text-muted-foreground",children:e.jsx(oe,{className:"h-5 w-5"})})})}),e.jsx(H,{children:n("validator.profileInfo")})]})})]}),e.jsxs(he,{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Q,{children:n("validator.selectProfile")}),e.jsxs(se,{modal:!1,children:[e.jsx(re,{asChild:!0,children:I(h(c.profile,c.version),T?.icon)}),e.jsx(te,{className:"min-w-[260px]",children:Object.keys(C).map(l=>{const u=C[l],v=u.versions[u.defaultVersion];return e.jsxs(ae,{onSelect:w=>{w.preventDefault(),j(l)},className:"flex items-center gap-3",children:[v.icon&&e.jsx("img",{src:v.icon,alt:"",className:"h-5 w-5"}),e.jsx("span",{children:h(l,u.defaultVersion)})]},l)})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Q,{children:n("validator.version")}),e.jsxs(se,{modal:!1,children:[e.jsx(re,{asChild:!0,children:P(c.version,z.length<=1)}),e.jsx(te,{children:z.map(l=>e.jsxs(ae,{onSelect:u=>{u.preventDefault(),S(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:l}),c.version===l&&e.jsx(le,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]}),E&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Q,{children:n("validator.branch")}),e.jsxs(se,{modal:!1,children:[e.jsx(re,{asChild:!0,children:P(y(b,g[b]),!1)}),e.jsx(te,{children:Object.entries(g).map(([l,u])=>e.jsxs(ae,{onSelect:v=>{v.preventDefault(),U(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:y(l,u)}),b===l&&e.jsx(le,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]})]}),e.jsxs(Qe,{className:"flex flex-wrap items-center justify-between gap-4 border-t border-border/60 bg-muted/30 px-6 py-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ne,{variant:"success",className:"uppercase tracking-tight",children:n("validator.currentProfile")}),e.jsx("span",{className:"text-xs text-muted-foreground/80",children:n("validator.profileReadyHint")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-muted-foreground",children:[e.jsx(le,{className:"h-4 w-4 text-emerald-500","aria-hidden":"true"}),e.jsxs("span",{className:"font-medium text-foreground",children:[n("validator.validatingAgainst"),": ",e.jsx("span",{className:"text-muted-foreground",children:h(c.profile,c.version)})]})]})]})]})},ls=({shaclFiles:c,onChange:p})=>{const{t:s}=Y(),[n,C]=a.useState("paste"),[h,y]=a.useState(""),[j,S]=a.useState(""),[U,N]=a.useState(null),[T,z]=a.useState(!1),g=()=>`shacl-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,E=a.useCallback(o=>{p([...c,o])},[c,p]),b=a.useCallback(o=>{p(c.filter(i=>i.id!==o))},[c,p]),I=()=>{if(!h.trim())return;const o={id:g(),content:h,source:"paste"};E(o),y("")},P=async()=>{if(j.trim()){z(!0),N(null);try{const o=await fetch(j);if(!o.ok)throw new Error(`HTTP ${o.status}`);const i=await o.text(),R={id:g(),content:i,source:"url",url:j};E(R),S("")}catch(o){N(s("validator.urlError")),console.error("Failed to load SHACL from URL:",o)}finally{z(!1)}}},l=a.useCallback(async o=>{for(const i of o)try{const R=await i.text(),M={id:g(),content:R,source:"upload"};E(M)}catch(R){console.error(`Failed to read file ${i.name}:`,R)}},[E]),{getRootProps:u,getInputProps:v,isDragActive:w}=ke({onDrop:l,accept:{"text/turtle":[".ttl",".shacl"],"application/rdf+xml":[".rdf",".xml"],"application/ld+json":[".jsonld"]},multiple:!0});return e.jsxs(ue,{className:"border-dashed border-2 border-primary/30",children:[e.jsx(me,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),s("profiles.manager.title")]}),e.jsx(pe,{children:s("profiles.manager.description")})]}),c.length>0&&e.jsxs(ne,{variant:"outline",children:[c.length," ",s("profiles.manager.filesLoaded")]})]})}),e.jsxs(he,{className:"space-y-4",children:[c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:s("profiles.manager.loadedFiles")}),e.jsx("div",{className:"space-y-2",children:c.map((o,i)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(ie,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s("profiles.manager.file")," #",i+1,o.url&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",new URL(o.url).hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs(ne,{variant:"outline",className:"text-xs",children:[o.source==="paste"&&e.jsx(de,{className:"h-3 w-3 mr-1"}),o.source==="upload"&&e.jsx(_,{className:"h-3 w-3 mr-1"}),o.source==="url"&&e.jsx(ce,{className:"h-3 w-3 mr-1"}),s(`profiles.manager.source.${o.source}`)]}),e.jsxs("span",{children:[(o.content.length/1024).toFixed(1)," KB"]})]})]})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>b(o.id),className:"shrink-0",children:e.jsx(Xe,{className:"h-4 w-4"})})]},o.id))})]}),e.jsxs(De,{value:n,onValueChange:o=>C(o),className:"w-full",children:[e.jsxs(Ee,{className:"grid w-full grid-cols-3",children:[e.jsxs(O,{value:"paste",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.paste")]}),e.jsxs(O,{value:"upload",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.upload")]}),e.jsxs(O,{value:"url",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),s("profiles.manager.tabs.url")]})]}),e.jsxs(J,{value:"paste",className:"space-y-3 mt-4",children:[e.jsx(We,{placeholder:s("profiles.manager.pastePlaceholder"),value:h,onChange:o=>y(o.target.value),className:"min-h-[200px] font-mono text-sm"}),e.jsxs(k,{onClick:I,disabled:!h.trim(),className:"w-full",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),s("profiles.manager.addFile")]})]}),e.jsx(J,{value:"upload",className:"mt-4",children:e.jsxs("div",{...u(),className:L("flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 text-center transition-colors cursor-pointer",w?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-muted/30"),children:[e.jsx("input",{...v()}),e.jsx(_,{className:L("h-12 w-12 mb-4",w?"text-primary":"text-muted-foreground")}),e.jsx("p",{className:"text-sm font-medium",children:s(w?"profiles.manager.dropActive":"profiles.manager.dropInactive")}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:s("profiles.manager.dropHint")})]})}),e.jsxs(J,{value:"url",className:"space-y-3 mt-4",children:[e.jsx(Te,{placeholder:s("profiles.manager.urlPlaceholder"),value:j,onChange:o=>{S(o.target.value),N(null)}}),U&&e.jsxs("div",{className:"flex items-start gap-2 rounded-lg border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800 dark:border-yellow-900 dark:bg-yellow-950 dark:text-yellow-200",children:[e.jsx(G,{className:"h-4 w-4 mt-0.5 shrink-0"}),e.jsx("p",{children:U})]}),e.jsx(k,{onClick:P,disabled:!j.trim()||T,className:"w-full",children:T?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),s("common.loading")]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),s("profiles.manager.loadUrl")]})})]})]})]})]})},ns=({mode:c,onChange:p,disabled:s=!1})=>{const{t:n}=Y();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Q,{children:n("validator.validationMode")}),e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-border bg-muted/30 p-1",children:[e.jsxs("button",{onClick:()=>p("predefined"),disabled:s,className:L("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",c==="predefined"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx(Ye,{className:"h-4 w-4"}),n("validator.mode.predefined")]}),e.jsxs("button",{onClick:()=>p("custom"),disabled:s,className:L("inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-all","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50",c==="custom"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx(Ze,{className:"h-4 w-4"}),n("validator.mode.custom")]})]})]})},Fe=a.forwardRef(({className:c,value:p=0,...s},n)=>e.jsx("div",{ref:n,className:L("relative h-2 w-full overflow-hidden rounded-full bg-muted",c),...s,children:e.jsx("div",{className:"h-full w-full flex-1 rounded-full bg-gradient-to-r from-primary to-accent transition-all",style:{transform:`translateX(-${100-Math.min(100,Math.max(0,p))}%)`}})}));Fe.displayName="Progress";function we({className:c,...p}){return e.jsx("div",{className:L("animate-pulse rounded-md bg-muted/60",c),...p})}const ye=Je.lazy(()=>qe(()=>import("./monaco-DDTMawMR.js"),__vite__mapDeps([0,1]))),os=({value:c,onChange:p,jsonPreview:s})=>{const{t:n}=Y(),{theme:C}=Se(),[h,y]=a.useState(!1),S=C==="dark"?"vs-dark":"vs-light",U="flex min-h-[57px] items-center justify-between border-b border-border px-4 py-2",N=async()=>{if(s)try{await navigator.clipboard.writeText(s),y(!0),setTimeout(()=>y(!1),2e3)}catch(T){console.error("Failed to copy:",T)}};return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsxs("div",{className:`${U} text-xs text-muted-foreground`,children:[e.jsx("span",{className:"uppercase tracking-wide",children:n("validator.pasteText")}),e.jsx(X,{children:e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(G,{className:"h-3.5 w-3.5"})})}),e.jsx(H,{children:e.jsx("p",{className:"text-xs",children:n("validator.supportedFormats")})})]})})]}),e.jsx("div",{className:"h-[420px]",children:e.jsx(a.Suspense,{fallback:e.jsx(we,{className:"h-full w-full rounded-none"}),children:e.jsx(ye,{height:"100%",defaultLanguage:"turtle",theme:S,value:c,onChange:T=>p(T||""),options:{minimap:{enabled:!1},wordWrap:"on",fontSize:14,fontFamily:"JetBrains Mono",scrollBeyondLastLine:!1,automaticLayout:!0,renderLineHighlight:"none"}})})})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsxs("div",{className:U,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:n("validator.previewLabel")}),e.jsx("span",{className:"rounded-full bg-primary/10 px-2 py-1 text-[10px] font-medium text-primary",children:n("validator.jsonPreview")})]}),s&&e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:N,"aria-label":n("validator.copyJsonLd"),children:h?e.jsx(Ke,{className:"h-3.5 w-3.5 text-green-600"}):e.jsx(es,{className:"h-3.5 w-3.5"})})}),e.jsx(H,{children:n(h?"validator.copied":"validator.copyJsonLd")})]}),e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>window.open("https://json-ld.org/","_blank","noopener,noreferrer"),"aria-label":n("validator.jsonLdHelp"),children:e.jsx(ss,{className:"h-3.5 w-3.5"})})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[n("validator.jsonLdHelp"),e.jsx(rs,{className:"h-3 w-3"})]})})]})]})})]}),e.jsx("div",{className:"h-[420px]",children:s?e.jsx(a.Suspense,{fallback:e.jsx(we,{className:"h-full w-full rounded-none"}),children:e.jsx(ye,{height:"100%",defaultLanguage:"json",theme:S,value:s,options:{readOnly:!0,minimap:{enabled:!1},wordWrap:"on",fontSize:13,fontFamily:"JetBrains Mono",automaticLayout:!0,renderLineHighlight:"none"}})}):e.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:n("validator.previewEmpty")})})})]})]})},Ce=256*1024,Z={datasets:0,dataServices:0,distributions:0,hasData:!1},vs=({onValidate:c,isLoading:p})=>{const{t:s}=Y(),{setRdfStats:n}=Se(),[C]=Ge(),[h,y]=a.useState("paste"),[j,S]=a.useState(""),[U,N]=a.useState(""),[T,z]=a.useState(""),[g,E]=a.useState(""),[b,I]=a.useState(null),[P,l]=a.useState(null),[u,v]=a.useState({progress:0,isUploading:!1,error:null}),[w,o]=a.useState(null),[i,R]=a.useState({profile:"dcat_ap_es",version:"1.0.0",branch:"main",mode:"predefined"}),[M,Le]=a.useState([]),ee=a.useRef(!1),[V,W]=a.useState(Z);a.useEffect(()=>{const r=C.get("sample");if(r){const f=K.profiles[i.profile]?.versions[i.version]?.samples?.[r];f&&(E(f),y("url"))}},[C,i]),a.useEffect(()=>{if(!j.trim()){N(""),z(""),W({...Z});return}let r=!1;return(async()=>{try{const m=B.detectFormat(j);if(m==="application/ld+json"||m==="application/json"){N(""),z(""),W({...Z});return}const x=await B.parseRDF(j,m);if(r)return;const f=await B.normalizeToTurtle(j,{format:m});if(r)return;N(f),z(JSON.stringify(Ue(x),null,2));const d=fe(x);W({...d,hasData:!0})}catch(m){console.error("Preview error",m),W({...Z})}})(),()=>{r=!0}},[j]);const Ue=r=>{const t={},m=r.getQuads(null,null,null,null);for(const x of m){const f=x.subject.value;t[f]||(t[f]={"@id":f});const d=x.predicate.value,F=x.object.termType==="Literal"?{"@value":x.object.value,"@type":x.object.datatype?.value,"@language":x.object.language||void 0}:{"@id":x.object.value};t[f][d]?t[f][d]=Array.isArray(t[f][d])?[...t[f][d],F]:[t[f][d],F]:t[f][d]=F}return Object.values(t)},fe=r=>{const t="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",m="http://www.w3.org/ns/dcat#Dataset",x="http://www.w3.org/ns/dcat#DataService",f="http://www.w3.org/ns/dcat#Distribution",d={datasets:new Set,dataServices:new Set,distributions:new Set},F=r.getQuads(null,null,null,null);for(const D of F){if(D.predicate.value!==t)continue;const q=D.subject.value;switch(D.object.value){case m:d.datasets.add(q);break;case x:d.dataServices.add(q);break;case f:d.distributions.add(q);break}}return{datasets:d.datasets.size,dataServices:d.dataServices.size,distributions:d.distributions.size}},ze=async()=>{let r=j,t=null;const m={url:h==="url"?g:void 0,contentType:t||b?.contentType||null};if(h==="url"){if(!g.trim())return;try{const d=await fetch(g);if(!d.ok)throw new Error(`HTTP error ${d.status}`);t=d.headers.get("content-type"),m.contentType=t||b?.contentType||null,r=await d.text()}catch(d){console.error(d),l(s("validator.urlError"));return}}if(h==="upload"&&!j.trim())return;let x=null;try{if(x=B.detectFormat(r,m.url,m.contentType),x!=="text/turtle"&&x!=="turtle"){const d=await B.normalizeToTurtle(r,{format:x,url:h==="url"?g:void 0,contentType:t||b?.contentType||null});r=d,x="text/turtle",h!=="url"&&S(d)}}catch(d){console.error("Normalization error",d),x=x||"text/turtle"}if(h!=="paste"||!V.hasData)try{const d=x||B.detectFormat(r,m.url,m.contentType);if(d!=="application/ld+json"){const F=await B.parseRDF(r,d),D=fe(F);W({...D,hasData:!0})}}catch(d){console.warn("Failed to derive RDF stats",d)}const f={...i,customShacl:i.mode==="custom"?M:void 0};c(r,f)},je=a.useCallback(async r=>{if(!r.trim()){I(null);return}l(null);try{const t=await fetch(r,{method:"HEAD"});if(t.ok){I({size:t.headers.get("content-length")||void 0,contentType:t.headers.get("content-type")||void 0});return}}catch{console.warn("HEAD request failed, falling back to GET metadata")}try{const t=await fetch(r,{method:"GET"});if(!t.ok)throw new Error("Failed metadata fetch");I({size:t.headers.get("content-length")||void 0,contentType:t.headers.get("content-type")||void 0})}catch(t){console.error(t),I(null)}},[]);a.useEffect(()=>{if(!g.trim()){I(null);return}const r=setTimeout(()=>{je(g)},500);return()=>clearTimeout(r)},[g,je]);const ge=a.useCallback(r=>new Promise((t,m)=>{const x=new FileReader;let f=0,d="";ee.current=!1,v({progress:0,isUploading:!0,error:null});const F=()=>{if(ee.current){v({progress:0,isUploading:!1,error:s("validator.uploadCancelled")}),m(new Error("Upload cancelled"));return}const D=r.slice(f,f+Ce);x.readAsText(D)};x.onload=D=>{d+=D.target?.result,f+=Ce;const q=Math.min(100,Math.round(f/r.size*100));v(Oe=>({...Oe,progress:q})),f<r.size?F():(v({progress:100,isUploading:!1,error:null}),t(d))},x.onerror=()=>{const D=x.error?.message||"Upload error";v({progress:0,isUploading:!1,error:D}),o(null),m(x.error||new Error(D))},F()}),[s]),Ie=a.useCallback(async r=>{if(!r.length)return;const t=r[0];try{const m=await ge(t);S(m),y("upload"),o(t.name)}catch(m){console.error(m),o(null)}},[ge]),Re=a.useCallback(r=>{if(r.length>0){const m=r[0].file.name,x=m.substring(m.lastIndexOf(".")).toLowerCase();v({progress:0,isUploading:!1,error:s("validator.unsupportedFormatError",{extension:x})})}},[s]),Me=a.useCallback(()=>{S(""),o(null),v({progress:0,isUploading:!1,error:null})},[]),Pe=()=>{ee.current=!0,o(null)},{getRootProps:Be,getInputProps:Ve,isDragActive:ve}=ke({accept:{"text/turtle":[".ttl"],"text/n3":[".n3"],"application/rdf+xml":[".rdf",".xml"],"application/ld+json":[".jsonld",".json"]},multiple:!1,onDropAccepted:Ie,onDropRejected:Re}),Ae=()=>{let m=K.profiles[i.profile]?.versions[i.version]?.sampleUrl;m&&i.branch&&(m=m.replace("{branch}",i.branch)),m&&(E(m),y("url"))};a.useEffect(()=>{const r=K.profiles;if(!V.hasData){n(null);return}const t=r[i.profile]?.versions?.[i.version]?.icon;n({datasets:V.datasets,dataServices:V.dataServices,distributions:V.distributions,profileId:i.profile,profileVersion:i.version,profileBranch:i.branch,profileIcon:t})},[V,i,n]),a.useEffect(()=>()=>n(null),[n]);const $e=a.useMemo(()=>{const r={success:"bg-emerald-500/15 text-emerald-600 dark:text-emerald-300",info:"bg-sky-500/15 text-sky-700 dark:text-sky-200",progress:"bg-primary/15 text-primary"};return[{key:"paste",title:s("validator.actions.pasteTitle"),description:s("validator.actions.pasteDescription"),icon:de,active:h==="paste",status:j?{label:s("validator.actions.ready"),style:r.success}:void 0},{key:"upload",title:s("validator.actions.uploadTitle"),description:s("validator.actions.uploadDescription"),icon:_,active:h==="upload",status:u.isUploading?{label:`${u.progress}%`,style:r.progress}:w?{label:w,style:r.info}:void 0},{key:"url",title:s("validator.actions.urlTitle"),description:s("validator.actions.urlDescription"),icon:ce,active:h==="url",status:b?.contentType?{label:b.contentType.split(";")[0],style:r.info}:void 0}]},[h,j,b,u,w,s]),He=a.useMemo(()=>p||i.mode==="custom"&&M.length===0?!0:h==="paste"?!j.trim():h==="url"?!g.trim():h==="upload"?!j.trim():!0,[h,j,g,p,i.mode,M.length]),_e=r=>{R(t=>({...t,mode:r}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ns,{mode:i.mode,onChange:_e,disabled:p}),i.mode==="predefined"?e.jsx(as,{selectedProfile:i,onProfileChange:R,disabled:p}):e.jsx(ls,{shaclFiles:M,onChange:Le}),e.jsxs(ue,{children:[e.jsxs(me,{children:[e.jsx(xe,{children:s("validator.workspaceTitle")}),e.jsx(pe,{children:s("validator.workspaceSubtitle")})]}),e.jsxs(he,{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:$e.map(r=>e.jsxs("button",{onClick:()=>y(r.key),className:L("rounded-2xl border p-4 text-left transition-all hover:border-primary hover:shadow-md",r.active?"border-primary/50 bg-primary/5":"border-border"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.icon,{className:"h-5 w-5 text-primary","aria-hidden":"true"}),r.status&&e.jsx("span",{className:L("rounded-full px-2 py-0.5 text-xs font-semibold",r.status.style),children:r.status.label})]}),e.jsx("p",{className:"mt-3 font-semibold text-sm",children:r.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.description})]},r.key))}),e.jsxs(De,{value:h,onValueChange:r=>y(r),children:[e.jsxs(Ee,{className:"w-full gap-2",children:[e.jsx(O,{value:"paste",children:s("validator.pasteText")}),e.jsx(O,{value:"upload",children:s("validator.uploadTab")}),e.jsx(O,{value:"url",children:s("validator.url")})]}),e.jsx(J,{value:"paste",className:"border-0 p-0",children:e.jsx(a.Suspense,{fallback:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ne,{className:"h-4 w-4 animate-spin"})," ",s("validator.loadingEditor")]}),children:e.jsx(os,{value:j,onChange:S,normalizedContent:U,jsonPreview:T})})}),e.jsx(J,{value:"url",className:"border-0 p-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Te,{type:"url",placeholder:s("validator.urlPlaceholder"),value:g,onChange:r=>E(r.target.value),disabled:p}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(X,{children:e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center gap-1 hover:text-foreground transition-colors",children:[e.jsx(oe,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:s("validator.supportedFormats")})]})}),e.jsx(H,{children:e.jsx("p",{className:"text-xs",children:s("validator.supportedFormats")})})]})}),e.jsx("span",{className:"text-muted-foreground/60",children:"|"}),e.jsx("span",{children:s("validator.corsWarning")})]}),b&&e.jsxs("div",{className:"rounded-2xl border border-dashed border-border p-4 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[s("validator.metadata.type"),":"]})," ",b.contentType||s("validator.metadata.unknown")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[s("validator.metadata.size"),":"]})," ",b.size?`${Math.round(Number(b.size)/1024)} KB`:s("validator.metadata.unknown")]})]}),P&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(G,{className:"h-4 w-4"}),P]})]})}),e.jsx(J,{value:"upload",className:"border-0 p-0 pt-4",children:w&&!u.isUploading?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border/70 bg-muted/30 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s("validator.fileLoaded")})]})]}),e.jsx(k,{variant:"ghost",size:"icon",onClick:Me,className:"h-8 w-8 text-muted-foreground hover:text-destructive","aria-label":s("common.clear"),children:e.jsx(ts,{className:"h-4 w-4"})})]})}):u.isUploading?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-border/70 bg-muted/30 px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(_,{className:"h-5 w-5 text-primary animate-pulse"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s("validator.uploading")})]})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:Pe,className:"text-muted-foreground hover:text-destructive",children:s("validator.cancelUpload")})]}),e.jsx(Fe,{value:u.progress,className:"h-2"}),e.jsx("div",{className:"mt-2 flex items-center justify-between",children:e.jsxs("span",{className:"text-xs text-muted-foreground",children:[u.progress,"%"]})})]}),u.error&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(G,{className:"h-4 w-4"}),u.error]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{...Be(),className:L("cursor-pointer rounded-2xl border-2 border-dashed transition-colors",ve?"border-primary bg-primary/5":"border-border/70 hover:border-primary/50 hover:bg-muted/30"),children:[e.jsx("input",{...Ve()}),e.jsxs("div",{className:"flex flex-col items-center gap-4 px-6 py-12 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(_,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:s(ve?"validator.dropActive":"validator.dropInactive")}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s("validator.dropSubtitle")}),e.jsx(X,{children:e.jsxs(A,{children:[e.jsx($,{asChild:!0,children:e.jsxs("button",{className:"mt-2 inline-flex items-center gap-1 text-xs text-muted-foreground/80 hover:text-muted-foreground transition-colors",children:[e.jsx(oe,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:s("validator.supportedFormats")})]})}),e.jsx(H,{children:e.jsx("p",{className:"text-xs",children:s("validator.supportedFormats")})})]})})]})]})]}),u.error&&e.jsx("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-destructive"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:u.error}),e.jsxs("p",{className:"text-xs text-destructive/80",children:[s("validator.converterHint")," ",e.jsx("a",{href:"https://www.easyrdf.org/converter",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-destructive",children:"EasyRDF Converter"})]})]})]})})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card/70 p-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("validator.currentProfile")}),e.jsx("p",{className:"font-semibold text-foreground",children:i.mode==="custom"?`${s("validator.mode.custom")} (${M.length} ${M.length===1?"file":"files"})`:`${s(`profiles.names.${i.profile}.${i.version}`,{defaultValue:i.profile})} Â· ${i.branch}`})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.mode==="predefined"&&e.jsx(k,{variant:"ghost",onClick:Ae,disabled:p,children:s("validator.loadSample")}),e.jsx(k,{onClick:ze,disabled:He,className:"min-w-[160px]",children:p?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"mr-2 h-4 w-4 animate-spin"}),s("common.validating")]}):s("common.validate")})]})]})]})]})]})};export{vs as default};

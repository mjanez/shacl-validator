const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-0iGas82m.js","assets/icons-DG6W60MC.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-ByzBnfWA.js";import{r as n,I as ze,h as O,W as Ee,T as Re,i as W,j as Be,k as re,l as ae,m as Ie,X as Me}from"./icons-DG6W60MC.js";import{u as Pe}from"./index-UlUhn1sP.js";import{c as I,u as Z,a as _,T as Ue,b as Ve,d as Fe,B as E,e as Le,D as q,f as J,g as G,h as Q,i as ie,_ as Ae,j as _e,R as z}from"./index-aw08U1Dc.js";import{C as de,a as ce,b as ue,c as me,d as pe,e as $e}from"./card-rTp3vAT8.js";import{B as He}from"./badge-Bih_XMLh.js";import{T as xe,a as fe,b as L,c as X}from"./tabs-CgTPWjO4.js";import{I as Oe}from"./input-CPUvZrsk.js";import"./index-CeW4QOa1.js";import"./ui-C9vahUD6.js";import"./shacl-VT5Co26k.js";const $=n.forwardRef(({className:u,...f},t)=>e.jsx("label",{ref:t,className:I("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",u),...f}));$.displayName="Label";const We=({selectedProfile:u,onProfileChange:f,disabled:t=!1})=>{const{t:c}=Z(),b=_.profiles,m=(l,d)=>{const w=b[l]?.versions?.[d];return w?c(`profiles.names.${l}.${d}`,{defaultValue:w.name}):l},N=(l,d)=>c(`profiles.branches.${l}`,{defaultValue:d||l}),h=l=>{const d=b[l].defaultVersion,g=b[l].defaultBranch||"main";f({profile:l,version:d,branch:g})},S=l=>{f({...u,version:l})},R=l=>{f({...u,branch:l})},y=b[u.profile],k=y.versions[u.version],M=Object.keys(y.versions).sort().reverse(),v=y.branches||{},P=Object.keys(v).length>0,j=u.branch||y.defaultBranch||"main",D=l=>e.jsxs(E,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:t,children:[e.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[k.icon&&e.jsx("img",{src:k.icon,alt:"",className:"h-6 w-6"}),l]}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]}),U=(l,d)=>e.jsxs(E,{variant:"outline",className:"h-12 justify-between gap-2 border-border/70",disabled:t||d,children:[e.jsx("span",{className:"text-sm font-medium",children:l}),e.jsx("svg",{className:"h-4 w-4 text-muted-foreground",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",children:e.jsx("path",{d:"M6 8l4 4 4-4"})})]});return e.jsxs(de,{className:"border border-border/70 bg-card",children:[e.jsxs(ce,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(ue,{className:"text-base",children:c("validator.selectProfile")}),e.jsx(me,{children:c("validator.workspaceSubtitle")})]}),e.jsx(Ue,{children:e.jsxs(Ve,{children:[e.jsx(Fe,{asChild:!0,children:e.jsx(E,{variant:"ghost",size:"icon",asChild:!0,"aria-label":c("validator.profileInfo")??"Profile documentation",children:e.jsx("a",{href:k.url,target:"_blank",rel:"noreferrer",className:"text-muted-foreground",children:e.jsx(ze,{className:"h-5 w-5"})})})}),e.jsx(Le,{children:c("validator.profileInfo")})]})})]}),e.jsxs(pe,{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{children:c("validator.selectProfile")}),e.jsxs(q,{modal:!1,children:[e.jsx(J,{asChild:!0,children:D(m(u.profile,u.version))}),e.jsx(G,{className:"min-w-[260px]",children:Object.keys(b).map(l=>{const d=b[l],g=d.versions[d.defaultVersion];return e.jsxs(Q,{onSelect:w=>{w.preventDefault(),h(l)},className:"flex items-center gap-3",children:[g.icon&&e.jsx("img",{src:g.icon,alt:"",className:"h-5 w-5"}),e.jsx("span",{children:m(l,d.defaultVersion)})]},l)})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{children:c("validator.version")}),e.jsxs(q,{modal:!1,children:[e.jsx(J,{asChild:!0,children:U(u.version,M.length<=1)}),e.jsx(G,{children:M.map(l=>e.jsxs(Q,{onSelect:d=>{d.preventDefault(),S(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:l}),u.version===l&&e.jsx(O,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]}),P&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{children:c("validator.branch")}),e.jsxs(q,{modal:!1,children:[e.jsx(J,{asChild:!0,children:U(N(j,v[j]),!1)}),e.jsx(G,{children:Object.entries(v).map(([l,d])=>e.jsxs(Q,{onSelect:g=>{g.preventDefault(),R(l)},className:"flex items-center justify-between",children:[e.jsx("span",{children:N(l,d)}),j===l&&e.jsx(O,{className:"h-4 w-4 text-primary","aria-hidden":"true"})]},l))})]})]})]}),e.jsxs($e,{className:"flex flex-wrap items-center justify-between gap-4 border-t border-border/60 bg-muted/30 px-6 py-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(He,{variant:"success",className:"uppercase tracking-tight",children:c("validator.currentProfile")}),e.jsx("span",{className:"text-xs text-muted-foreground/80",children:c("validator.profileReadyHint")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-muted-foreground",children:[e.jsx(O,{className:"h-4 w-4 text-emerald-500","aria-hidden":"true"}),e.jsxs("span",{className:"font-medium text-foreground",children:[c("validator.validatingAgainst"),": ",e.jsx("span",{className:"text-muted-foreground",children:m(u.profile,u.version)})]})]})]})]})},he=n.forwardRef(({className:u,value:f=0,...t},c)=>e.jsx("div",{ref:c,className:I("relative h-2 w-full overflow-hidden rounded-full bg-muted",u),...t,children:e.jsx("div",{className:"h-full w-full flex-1 rounded-full bg-gradient-to-r from-primary to-accent transition-all",style:{transform:`translateX(-${100-Math.min(100,Math.max(0,f))}%)`}})}));he.displayName="Progress";function le({className:u,...f}){return e.jsx("div",{className:I("animate-pulse rounded-md bg-muted/60",u),...f})}const ne=Ee.lazy(()=>Ae(()=>import("./monaco-0iGas82m.js"),__vite__mapDeps([0,1]))),qe=({value:u,onChange:f,normalizedContent:t,jsonPreview:c})=>{const[b,m]=n.useState("json"),{t:N}=Z(),{theme:h}=ie(),R=h==="dark"?"vs-dark":"vs-light",y="flex min-h-[57px] items-center justify-between border-b border-border px-4 py-2";return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsx("div",{className:`${y} text-xs uppercase tracking-wide text-muted-foreground`,children:N("validator.pasteText")}),e.jsx("div",{className:"h-[420px]",children:e.jsx(n.Suspense,{fallback:e.jsx(le,{className:"h-full w-full rounded-none"}),children:e.jsx(ne,{height:"100%",defaultLanguage:"turtle",theme:R,value:u,onChange:k=>f(k||""),options:{minimap:{enabled:!1},wordWrap:"on",fontSize:14,fontFamily:"JetBrains Mono",scrollBeyondLastLine:!1,automaticLayout:!0,renderLineHighlight:"none"}})})})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card/70",children:[e.jsxs("div",{className:y,children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:N("validator.previewLabel")}),e.jsx(xe,{value:b,onValueChange:k=>m(k),children:e.jsxs(fe,{className:"bg-transparent p-0",children:[e.jsx(L,{value:"json",className:"rounded-full px-3 py-1 text-xs",children:N("validator.jsonPreview")}),e.jsx(L,{value:"turtle",className:"rounded-full px-3 py-1 text-xs",children:N("validator.normalizedPreview")})]})})]}),e.jsx("div",{className:"h-[420px]",children:e.jsx(n.Suspense,{fallback:e.jsx(le,{className:"h-full w-full rounded-none"}),children:e.jsx(ne,{height:"100%",defaultLanguage:b==="json"?"json":"turtle",theme:R,value:b==="json"?c:t,options:{readOnly:!0,minimap:{enabled:!1},wordWrap:"on",fontSize:13,fontFamily:"JetBrains Mono",automaticLayout:!0,renderLineHighlight:"none"}})})})]})]})},oe=256*1024,Y={datasets:0,dataServices:0,distributions:0,hasData:!1},as=({onValidate:u,isLoading:f})=>{const{t}=Z(),{setRdfStats:c}=ie(),[b]=_e(),[m,N]=n.useState("paste"),[h,S]=n.useState(""),[R,y]=n.useState(""),[k,M]=n.useState(""),[v,P]=n.useState(""),[j,D]=n.useState(null),[U,l]=n.useState(null),[d,g]=n.useState({progress:0,isUploading:!1,error:null}),[w,V]=n.useState(null),[x,ve]=n.useState({profile:"dcat_ap_es",version:"1.0.0",branch:"main"}),H=n.useRef(!1),[B,A]=n.useState(Y);n.useEffect(()=>{const s=b.get("sample");if(s){const r=_.profiles[x.profile]?.versions[x.version]?.samples?.[s];r&&(P(r),N("url"))}},[b,x]),n.useEffect(()=>{if(!h.trim()){y(""),M(""),A({...Y});return}let s=!1;return(async()=>{try{const o=z.detectFormat(h),i=await z.parseRDF(h,o);if(s)return;const r=await z.normalizeToTurtle(h,{format:o});if(s)return;y(r),M(JSON.stringify(je(i),null,2));const p=K(i);A({...p,hasData:!0})}catch(o){console.error("Preview error",o),A({...Y})}})(),()=>{s=!0}},[h]);const je=s=>{const a={},o=s.getQuads(null,null,null,null);for(const i of o){const r=i.subject.value;a[r]||(a[r]={"@id":r});const p=i.predicate.value,T=i.object.termType==="Literal"?{"@value":i.object.value,"@type":i.object.datatype?.value,"@language":i.object.language||void 0}:{"@id":i.object.value};a[r][p]?a[r][p]=Array.isArray(a[r][p])?[...a[r][p],T]:[a[r][p],T]:a[r][p]=T}return Object.values(a)},K=s=>{const a="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",o="http://www.w3.org/ns/dcat#Dataset",i="http://www.w3.org/ns/dcat#DataService",r="http://www.w3.org/ns/dcat#Distribution",p={datasets:new Set,dataServices:new Set,distributions:new Set},T=s.getQuads(null,null,null,null);for(const C of T){if(C.predicate.value!==a)continue;const F=C.subject.value;switch(C.object.value){case o:p.datasets.add(F);break;case i:p.dataServices.add(F);break;case r:p.distributions.add(F);break}}return{datasets:p.datasets.size,dataServices:p.dataServices.size,distributions:p.distributions.size}},ge=async()=>{let s=h,a=null;const o={url:m==="url"?v:void 0,contentType:a||j?.contentType||null};if(m==="url"){if(!v.trim())return;try{const r=await fetch(v);if(!r.ok)throw new Error(`HTTP error ${r.status}`);a=r.headers.get("content-type"),o.contentType=a||j?.contentType||null,s=await r.text()}catch(r){console.error(r),l(t("validator.urlError"));return}}if(m==="upload"&&!h.trim())return;let i=null;try{if(i=z.detectFormat(s,o.url,o.contentType),i!=="text/turtle"&&i!=="turtle"){const r=await z.normalizeToTurtle(s,{format:i,url:m==="url"?v:void 0,contentType:a||j?.contentType||null});s=r,i="text/turtle",m!=="url"&&S(r)}}catch(r){console.error("Normalization error",r),i=i||"text/turtle"}if(m!=="paste"||!B.hasData)try{const r=i||z.detectFormat(s,o.url,o.contentType),p=await z.parseRDF(s,r),T=K(p);A({...T,hasData:!0})}catch(r){console.warn("Failed to derive RDF stats",r)}u(s,x)},ee=n.useCallback(async s=>{if(!s.trim()){D(null);return}l(null);try{const a=await fetch(s,{method:"HEAD"});if(a.ok){D({size:a.headers.get("content-length")||void 0,contentType:a.headers.get("content-type")||void 0});return}}catch{console.warn("HEAD request failed, falling back to GET metadata")}try{const a=await fetch(s,{method:"GET"});if(!a.ok)throw new Error("Failed metadata fetch");D({size:a.headers.get("content-length")||void 0,contentType:a.headers.get("content-type")||void 0})}catch(a){console.error(a),D(null)}},[]);n.useEffect(()=>{if(!v.trim()){D(null);return}const s=setTimeout(()=>{ee(v)},500);return()=>clearTimeout(s)},[v,ee]);const se=n.useCallback(s=>new Promise((a,o)=>{const i=new FileReader;let r=0,p="";H.current=!1,g({progress:0,isUploading:!0,error:null});const T=()=>{if(H.current){g({progress:0,isUploading:!1,error:t("validator.uploadCancelled")}),o(new Error("Upload cancelled"));return}const C=s.slice(r,r+oe);i.readAsText(C)};i.onload=C=>{p+=C.target?.result,r+=oe;const F=Math.min(100,Math.round(r/s.size*100));g(De=>({...De,progress:F})),r<s.size?T():(g({progress:100,isUploading:!1,error:null}),a(p))},i.onerror=()=>{const C=i.error?.message||"Upload error";g({progress:0,isUploading:!1,error:C}),V(null),o(i.error||new Error(C))},T()}),[t]),be=n.useCallback(async s=>{if(!s.length)return;const a=s[0];try{const o=await se(a);S(o),N("upload"),V(a.name)}catch(o){console.error(o),V(null)}},[se]),Ne=n.useCallback(()=>{S(""),V(null),g({progress:0,isUploading:!1,error:null})},[]),we=()=>{H.current=!0,V(null)},{getRootProps:ye,getInputProps:Te,isDragActive:te}=Pe({accept:{"text/*":[".ttl",".rdf",".nt",".nq"],"application/ld+json":[".jsonld",".json"]},multiple:!1,onDropAccepted:be}),Ce=()=>{let o=_.profiles[x.profile]?.versions[x.version]?.sampleUrl;o&&x.branch&&(o=o.replace("{branch}",x.branch)),o&&(P(o),N("url"))};n.useEffect(()=>{const s=_.profiles;if(!B.hasData){c(null);return}const a=s[x.profile]?.versions?.[x.version]?.icon;c({datasets:B.datasets,dataServices:B.dataServices,distributions:B.distributions,profileId:x.profile,profileVersion:x.version,profileBranch:x.branch,profileIcon:a})},[B,x,c]),n.useEffect(()=>()=>c(null),[c]);const ke=n.useMemo(()=>{const s={success:"bg-emerald-500/15 text-emerald-600 dark:text-emerald-300",info:"bg-sky-500/15 text-sky-700 dark:text-sky-200",progress:"bg-primary/15 text-primary"};return[{key:"paste",title:t("validator.actions.pasteTitle"),description:t("validator.actions.pasteDescription"),icon:Re,active:m==="paste",status:h?{label:t("validator.actions.ready"),style:s.success}:void 0},{key:"upload",title:t("validator.actions.uploadTitle"),description:t("validator.actions.uploadDescription"),icon:W,active:m==="upload",status:d.isUploading?{label:`${d.progress}%`,style:s.progress}:w?{label:w,style:s.info}:void 0},{key:"url",title:t("validator.actions.urlTitle"),description:t("validator.actions.urlDescription"),icon:Be,active:m==="url",status:j?.contentType?{label:j.contentType.split(";")[0],style:s.info}:void 0}]},[m,h,j,d,w,t]),Se=n.useMemo(()=>f?!0:m==="paste"?!h.trim():m==="url"?!v.trim():m==="upload"?!h.trim():!0,[m,h,v,f]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(We,{selectedProfile:x,onProfileChange:ve,disabled:f}),e.jsxs(de,{children:[e.jsxs(ce,{children:[e.jsx(ue,{children:t("validator.workspaceTitle")}),e.jsx(me,{children:t("validator.workspaceSubtitle")})]}),e.jsxs(pe,{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:ke.map(s=>e.jsxs("button",{onClick:()=>N(s.key),className:I("rounded-2xl border p-4 text-left transition-all hover:border-primary hover:shadow-md",s.active?"border-primary/50 bg-primary/5":"border-border"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(s.icon,{className:"h-5 w-5 text-primary","aria-hidden":"true"}),s.status&&e.jsx("span",{className:I("rounded-full px-2 py-0.5 text-xs font-semibold",s.status.style),children:s.status.label})]}),e.jsx("p",{className:"mt-3 font-semibold text-sm",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]},s.key))}),e.jsxs(xe,{value:m,onValueChange:s=>N(s),children:[e.jsxs(fe,{className:"w-full gap-2",children:[e.jsx(L,{value:"paste",children:t("validator.pasteText")}),e.jsx(L,{value:"upload",children:t("validator.uploadTab")}),e.jsx(L,{value:"url",children:t("validator.url")})]}),e.jsx(X,{value:"paste",className:"border-0 p-0",children:e.jsx(n.Suspense,{fallback:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"h-4 w-4 animate-spin"})," ",t("validator.loadingEditor")]}),children:e.jsx(qe,{value:h,onChange:S,normalizedContent:R,jsonPreview:k})})}),e.jsx(X,{value:"url",className:"border-0 p-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Oe,{type:"url",placeholder:t("validator.urlPlaceholder"),value:v,onChange:s=>P(s.target.value),disabled:f}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("validator.corsWarning")}),j&&e.jsxs("div",{className:"rounded-2xl border border-dashed border-border p-4 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("validator.metadata.type"),":"]})," ",j.contentType||t("validator.metadata.unknown")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("validator.metadata.size"),":"]})," ",j.size?`${Math.round(Number(j.size)/1024)} KB`:t("validator.metadata.unknown")]})]}),U&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),U]})]})}),e.jsx(X,{value:"upload",className:"border-0 p-0 pt-4",children:w&&!d.isUploading?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border/70 bg-muted/30 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(Ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t("validator.fileLoaded")})]})]}),e.jsx(E,{variant:"ghost",size:"icon",onClick:Ne,className:"h-8 w-8 text-muted-foreground hover:text-destructive","aria-label":t("common.clear"),children:e.jsx(Me,{className:"h-4 w-4"})})]})}):d.isUploading?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-border/70 bg-muted/30 px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(W,{className:"h-5 w-5 text-primary animate-pulse"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:w}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t("validator.uploading")})]})]}),e.jsx(E,{variant:"ghost",size:"sm",onClick:we,className:"text-muted-foreground hover:text-destructive",children:t("validator.cancelUpload")})]}),e.jsx(he,{value:d.progress,className:"h-2"}),e.jsx("div",{className:"mt-2 flex items-center justify-between",children:e.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.progress,"%"]})})]}),d.error&&e.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),d.error]})]}):e.jsxs("div",{...ye(),className:I("cursor-pointer rounded-2xl border-2 border-dashed transition-colors",te?"border-primary bg-primary/5":"border-border/70 hover:border-primary/50 hover:bg-muted/30"),children:[e.jsx("input",{...Te()}),e.jsxs("div",{className:"flex flex-col items-center gap-4 px-6 py-12 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(W,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-foreground",children:t(te?"validator.dropActive":"validator.dropInactive")}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:t("validator.dropSubtitle")})]})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card/70 p-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t("validator.currentProfile")}),e.jsxs("p",{className:"font-semibold text-foreground",children:[t(`profiles.names.${x.profile}.${x.version}`,{defaultValue:x.profile})," Â· ",x.branch]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(E,{variant:"ghost",onClick:Ce,disabled:f,children:t("validator.loadSample")}),e.jsx(E,{onClick:ge,disabled:Se,className:"min-w-[160px]",children:f?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4 animate-spin"}),t("common.validating")]}):t("common.validate")})]})]})]})]})]})};export{as as default};
